# åˆ·é¢˜ç¬”è®°
---

## 1. æ»‘åŠ¨çª—å£ï¼ˆSliding Windowï¼‰

### 1.1 æ ¸å¿ƒæ€æƒ³

æ»‘åŠ¨çª—å£æ˜¯ä¸€ç§é«˜æ•ˆè§£å†³**è¿ç»­åŒºé—´é—®é¢˜**çš„ç®—æ³•æŠ€å·§ã€‚
æœ¬è´¨æ€æƒ³ï¼šä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆ `left` å’Œ `right` ç»´æŠ¤ä¸€ä¸ªåŠ¨æ€åŒºé—´ `[left, right)`ï¼Œ
åœ¨éå†è¿‡ç¨‹ä¸­æ ¹æ®æ¡ä»¶æ‰©å¼ æˆ–æ”¶ç¼©çª—å£ã€‚

**å…¸å‹åº”ç”¨ï¼š**

* æœ€çŸ­/æœ€é•¿å­æ•°ç»„é•¿åº¦
* å­æ•°ç»„å’Œã€å¹³å‡å€¼ã€ä¹˜ç§¯é—®é¢˜
* ç¬¦åˆæ¡ä»¶çš„å­ä¸²ï¼ˆå¦‚æœ€å°è¦†ç›–å­ä¸²ï¼‰

æ»‘åŠ¨çª—å£å¯çœ‹ä½œâ€œåŒæŒ‡é’ˆâ€æŠ€å·§çš„ç‰¹åŒ–ï¼Œç”¨äºå¤„ç†**è¿ç»­åŒºé—´é—®é¢˜**ã€‚
è€Œâ€œåŒæŒ‡é’ˆâ€æ›´å¹¿æ³›ï¼Œç”¨äºæ’åºæ•°ç»„ã€é“¾è¡¨éå†ã€å¿«æ…¢æŒ‡é’ˆç­‰ã€‚

---

### 1.2 æ ‡å‡†é€»è¾‘ç»“æ„

```cpp
int left = 0, right = 0;
while (right < n) {
    // Step 1: æ‰©å¤§çª—å£
    æ›´æ–°çª—å£çŠ¶æ€;
    right++;

    // Step 2: æ”¶ç¼©çª—å£ï¼ˆæ»¡è¶³æ¡ä»¶æ—¶ï¼‰
    while (çª—å£æ»¡è¶³æ¡ä»¶) {
        æ›´æ–°ç­”æ¡ˆ;
        ç§»å‡º nums[left];
        left++;
    }
}
```

**ç‰¹å¾æ€»ç»“ï¼š**

* `right` æ‰©å±•çª—å£ï¼›
* `left` æ”¶ç¼©çª—å£ï¼›
* ä¸¤æŒ‡é’ˆåªå‘å³ç§»åŠ¨ï¼›
* æ¯ä¸ªå…ƒç´ æœ€å¤šè¢«è®¿é—®ä¸¤æ¬¡ â†’ æ—¶é—´å¤æ‚åº¦ O(n)ã€‚

---

### 1.3 ä¾‹é¢˜ï¼šLeetCode 209 â€“ Minimum Size Subarray Sum

ğŸ“ [LeetCode 209. Minimum Size Subarray Sum](https://leetcode.cn/problems/minimum-size-subarray-sum/)

#### 1.3.1 é¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ªæ­£æ•´æ•°æ•°ç»„ `nums` å’Œä¸€ä¸ªç›®æ ‡å€¼ `target`ï¼Œ
æ‰¾å‡ºå…¶å’Œ **â‰¥ target** çš„æœ€çŸ­è¿ç»­å­æ•°ç»„é•¿åº¦ã€‚
è‹¥ä¸å­˜åœ¨ï¼Œè¿”å› `0`ã€‚

**ç¤ºä¾‹è¾“å…¥ï¼š**

```cpp
target = 7
nums = [2,3,1,2,4,3]
```

**è¾“å‡ºï¼š**

```
2   // å¯¹åº”å­æ•°ç»„ [4,3]
```

---

### 1.4 ä»£ç å®ä¾‹å¯¹æ¯”

#### 1.4.1 æˆ‘çš„åŸå§‹å†™æ³•ï¼ˆéæ ‡å‡†ç‰ˆæœ¬ï¼‰

```cpp
class Solution {
public:
    int minSubArrayLen(int target, vector<int>& nums) {
        int n = nums.size();
        int left = 0, right = 0;
        int result = n + 1;
        int sum = 0;
        while (left < n && right < n) {
            while (sum < target && right < n) {
                sum += nums[right];
                right++;
            }
            while (sum >= target && left < right) {
                result = ((right - left) < result) ? (right - left) : result;
                sum -= nums[left];
                left++;
            }
        }
        if (result == n + 1)
            return 0;
        return result;
    }
};
```

**å­˜åœ¨é—®é¢˜ï¼š**

* å¤–å±‚æ¡ä»¶ `left < n && right < n` å¤šä½™ï¼›
* å¯èƒ½å¯¼è‡´å³æŒ‡é’ˆåœæ»ã€é™·å…¥æ­»å¾ªç¯ï¼›
* çª—å£é•¿åº¦å°‘è®¡ç®—äº† `+1`ï¼›
* å†…å¤–å±‚å¾ªç¯é€»è¾‘ä¸å¯¹ç§°ï¼Œå¯è¯»æ€§å·®ã€‚

---

#### 1.4.2 å®˜æ–¹æ ‡å‡†å†™æ³•ï¼ˆæ­£ç¡®ç‰ˆæœ¬ï¼‰

```cpp
class Solution {
public:
    int minSubArrayLen(int s, vector<int>& nums) {
        int n = nums.size();
        if (n == 0) return 0;

        int ans = INT_MAX;
        int start = 0, end = 0;
        int sum = 0;

        while (end < n) {
            sum += nums[end];
            while (sum >= s) {
                ans = min(ans, end - start + 1);
                sum -= nums[start];
                start++;
            }
            end++;
        }
        return ans == INT_MAX ? 0 : ans;
    }
};
```

**é€»è¾‘è¦ç‚¹ï¼š**

* å¤–å±‚å¾ªç¯ç§»åŠ¨ `end`ï¼›
* å†…å±‚å¾ªç¯æ”¶ç¼© `start`ï¼›
* æ¯ä¸ªå…ƒç´ ä»…è¢«åŠ å…¥ä¸ç§»å‡ºå„ä¸€æ¬¡ï¼›
* æ—¶é—´å¤æ‚åº¦ O(n)ï¼Œç©ºé—´å¤æ‚åº¦ O(1)ã€‚

---

### 1.5 æ‰§è¡Œè¿‡ç¨‹å¯è§†åŒ–

|  æ­¥éª¤ | çª—å£ `[start, end]` | å…ƒç´         | å½“å‰å’Œ | â‰¥7? | æœ€çŸ­é•¿åº¦ |
| :-: | :---------------- | :-------- | :-: | :-: | :--: |
|  1  | [0,0]             | [2]       |  2  |  å¦  |   -  |
|  2  | [0,1]             | [2,3]     |  5  |  å¦  |   -  |
|  3  | [0,2]             | [2,3,1]   |  6  |  å¦  |   -  |
|  4  | [0,3]             | [2,3,1,2] |  8  |  âœ…  |   4  |
|  5  | [1,3]             | [3,1,2]   |  6  |  å¦  |   -  |
|  6  | [1,4]             | [3,1,2,4] |  10 |  âœ…  |   4  |
|  7  | [2,4]             | [1,2,4]   |  7  |  âœ…  |   3  |
|  8  | [3,4]             | [2,4]     |  6  |  å¦  |   -  |
|  9  | [3,5]             | [2,4,3]   |  9  |  âœ…  |   3  |
|  10 | [4,5]             | [4,3]     |  7  |  âœ…  |   2  |

âœ… **æœ€ç»ˆç­”æ¡ˆï¼š2**

---

### 1.6 å¸¸è§é™·é˜±ä¸æ³¨æ„ç‚¹

| é”™è¯¯ç‚¹      | åŸå›                                  | ä¿®æ­£æ–¹æ³•                   |
| :------- | :--------------------------------- | :--------------------- |
| æŒ‡é’ˆæ›´æ–°æ–¹å‘é”™è¯¯ | `right` å›é€€ç ´åå•è°ƒæ€§                    | åªå¢ä¸é€€                   |
| å¤–å±‚æ¡ä»¶é”™è¯¯   | ä½¿ç”¨ `left < n && right < n` å¯¼è‡´å³æŒ‡é’ˆåœæ» | ç”¨ `while (right < n)`  |
| çª—å£é•¿åº¦è®¡ç®—é”™è¯¯ | å¿˜è®° `+1`                            | é•¿åº¦ = `end - start + 1` |
| sum æº¢å‡ºé—®é¢˜ | æœªåŠæ—¶æ”¶ç¼©                              | æ»¡è¶³æ¡ä»¶åç«‹å³è¿›å…¥æ”¶ç¼©å¾ªç¯          |
| ç»“æœåˆå§‹åŒ–ä¸å½“  | æ²¡ç”¨ INT_MAX                         | åº”åˆå§‹åŒ–ä¸ºæå¤§å€¼å¹¶æœ€ç»ˆåˆ¤æ–­          |

---

### 1.7 å¤æ‚åº¦åˆ†æ

* **æ—¶é—´å¤æ‚åº¦ï¼š** O(n)
  æ¯ä¸ªå…ƒç´ æœ€å¤šè¿›å…¥ä¸ç¦»å¼€çª—å£å„ä¸€æ¬¡ã€‚
* **ç©ºé—´å¤æ‚åº¦ï¼š** O(1)

---

### 1.8 æ€ç»´å£è¯€

> â€œæ»‘åŠ¨çª—å£çš„æœ¬è´¨æ˜¯ï¼š**æ‰©å±•ç›´åˆ°æ»¡è¶³ï¼Œæ”¶ç¼©ç›´åˆ°ä¸æ»¡è¶³**ã€‚â€

* å¯¹äºâ€œæœ€å°é•¿åº¦â€é—®é¢˜ï¼šæ»¡è¶³æ¡ä»¶æ—¶æ”¶ç¼©ï¼›
* å¯¹äºâ€œæœ€å¤§é•¿åº¦â€é—®é¢˜ï¼šä¸æ»¡è¶³æ¡ä»¶æ—¶æ‰©å±•ã€‚

---

### 1.9 æ¨¡æ¿è®°å¿†è¡¨

| é˜¶æ®µ | æ“ä½œ               | æ¡ä»¶           | ç›®çš„     |
| :- | :--------------- | :----------- | :----- |
| 1  | æ‰©å±•çª—å£ (`right++`) | æœªæ»¡è¶³æ¡ä»¶        | åŒ…å«æ›´å¤šå…ƒç´  |
| 2  | æ”¶ç¼©çª—å£ (`left++`)  | å·²æ»¡è¶³æ¡ä»¶        | å¯»æ‰¾æœ€ä¼˜è§£  |
| 3  | æ›´æ–°ç»“æœ             | æ»¡è¶³æ¡ä»¶æ—¶        | è®°å½•æœ€ä¼˜å€¼  |
| 4  | ç»“æŸå¾ªç¯             | `right == n` | éå†å®Œæ¯•   |

---

### 1.10 æ‹“å±•é¢˜å‹å»ºè®®

| é¢˜ç›®æ–¹å‘                | ç¤ºä¾‹ |
| :---------------------- | :--: |
| æœ€çŸ­å­æ•°ç»„å’Œ â‰¥ target   | [LeetCode 209 Â· Minimum Size Subarray Sum](https://leetcode.cn/problems/minimum-size-subarray-sum/) |
| å« K ä¸ªä¸åŒå­—ç¬¦çš„æœ€é•¿å­ä¸² | [LeetCode 340 Â· Longest Substring with At Most K Distinct Characters](https://leetcode.cn/problems/longest-substring-with-at-most-k-distinct-characters/) |
| æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²     | [LeetCode 3 Â· Longest Substring Without Repeating Characters](https://leetcode.cn/problems/longest-substring-without-repeating-characters/) |
| æœ€å°è¦†ç›–å­ä¸²             | [LeetCode 76 Â· Minimum Window Substring](https://leetcode.cn/problems/minimum-window-substring/) |
| å›ºå®šçª—å£æœ€å¤§/æœ€å°å€¼       | [LeetCode 239 Â· Sliding Window Maximum](https://leetcode.cn/problems/sliding-window-maximum/) |
---


## 2. é€’å½’ï¼ˆRecursionï¼‰

### 2.1 æ ¸å¿ƒæ€æƒ³  

**é€’å½’ï¼ˆRecursionï¼‰** æ˜¯ä¸€ç§â€œè®©å‡½æ•°è°ƒç”¨è‡ªèº«â€çš„ç®—æ³•æ€æƒ³ï¼Œç”¨äºè§£å†³å¯ä»¥åˆ†è§£ä¸ºç›¸ä¼¼å­é—®é¢˜çš„ä»»åŠ¡ã€‚  
é€’å½’åŒ…å«ä¸‰ä¸ªå…³é”®æ­¥éª¤ï¼š  

1. **ç»ˆæ­¢æ¡ä»¶ï¼ˆBase Caseï¼‰**ï¼šå½“é—®é¢˜è¶³å¤Ÿå°ï¼Œå¯ä»¥ç›´æ¥è¿”å›ç»“æœã€‚  
2. **é€’å½’è°ƒç”¨ï¼ˆRecurrenceï¼‰**ï¼šå°†å¤§é—®é¢˜åˆ†è§£ä¸ºæ›´å°çš„å­é—®é¢˜ã€‚  
3. **ç»“æœåˆå¹¶ï¼ˆReturn / Combineï¼‰**ï¼šå°†å­é—®é¢˜ç»“æœå‘ä¸Šä¼ é€’ã€‚

é“¾è¡¨æ˜¯å¤©ç„¶é€‚åˆé€’å½’çš„ç»“æ„ï¼Œå› ä¸ºæ¯ä¸ªèŠ‚ç‚¹éƒ½æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ•´ä¸ªé“¾è¡¨å°±åƒä¸€ä¸ªâ€œä»å¤´åˆ°å°¾çš„åµŒå¥—ç»“æ„â€ã€‚  
å› æ­¤ï¼Œè®¸å¤šé“¾è¡¨é¢˜ï¼ˆå¦‚åˆ é™¤èŠ‚ç‚¹ã€åè½¬é“¾è¡¨ã€åˆå¹¶é“¾è¡¨ï¼‰éƒ½èƒ½ç”¨é€’å½’ elegantly åœ°å®ç°ã€‚

---

### 2.2 ç§»é™¤é“¾è¡¨å…ƒç´ ï¼ˆRemove Linked List Elementsï¼‰

é¢˜å·ï¼šLeetCode 203  
é¢˜æ„ï¼šåˆ é™¤é“¾è¡¨ä¸­æ‰€æœ‰å€¼ç­‰äº `val` çš„èŠ‚ç‚¹ï¼Œå¹¶è¿”å›æ–°çš„å¤´èŠ‚ç‚¹ã€‚

---

#### 2.2.1 é€’å½’æ³•  

**æ€è·¯åˆ†æï¼š**  
- å¯¹é™¤å¤´èŠ‚ç‚¹å¤–çš„éƒ¨åˆ†é€’å½’åˆ é™¤ç›®æ ‡èŠ‚ç‚¹ï¼›
- å›æº¯æ—¶æ ¹æ®å½“å‰èŠ‚ç‚¹çš„å€¼å†³å®šæ˜¯å¦ä¿ç•™ï¼›
- ç©ºé“¾è¡¨ä¸ºé€’å½’ç»ˆæ­¢æ¡ä»¶ã€‚

**å…³é”®é€»è¾‘ï¼š**
```cpp
head->next = removeElements(head->next, val);
return head->val == val ? head->next : head;
```

**ä»£ç å®ç°ï¼š**

```cpp
class Solution {
public:
    ListNode* removeElements(ListNode* head, int val) {
        if (head == nullptr)
            return head;                        // é€’å½’ç»ˆæ­¢æ¡ä»¶
        head->next = removeElements(head->next, val); // é€’å½’å¤„ç†å­é“¾è¡¨
        return head->val == val ? head->next : head;  // å›æº¯é˜¶æ®µå†³å®šæ˜¯å¦åˆ é™¤å½“å‰èŠ‚ç‚¹
    }
};
```

**å¤æ‚åº¦åˆ†æï¼š**

* æ—¶é—´å¤æ‚åº¦ï¼šO(n)
* ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼ˆé€’å½’è°ƒç”¨æ ˆï¼‰

---

#### 2.2.2 è¿­ä»£æ³•ï¼ˆå®˜æ–¹å†™æ³•ï¼‰

**æ€è·¯åˆ†æï¼š**

* åˆ›å»ºä¸€ä¸ªå“‘èŠ‚ç‚¹ `dummyHead` è¿æ¥åŸé“¾è¡¨ï¼›
* ä½¿ç”¨æŒ‡é’ˆ `temp` éå†ï¼›
* è‹¥ `temp->next->val == val`ï¼Œåˆ™è·³è¿‡ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼›
* å¦åˆ™å‘åç§»åŠ¨ã€‚

**ä»£ç å®ç°ï¼š**

```cpp
class Solution {
public:
    ListNode* removeElements(ListNode* head, int val) {
        ListNode* dummyHead = new ListNode(0, head);
        ListNode* temp = dummyHead;
        while (temp->next != nullptr) {
            if (temp->next->val == val)
                temp->next = temp->next->next;
            else
                temp = temp->next;
        }
        return dummyHead->next;
    }
};
```

**å¤æ‚åº¦åˆ†æï¼š**

* æ—¶é—´å¤æ‚åº¦ï¼šO(n)
* ç©ºé—´å¤æ‚åº¦ï¼šO(1)

---

#### 2.2.3 æˆ‘çš„ç‰ˆæœ¬ï¼ˆæ‰‹åŠ¨è·³è¿‡å¤´èŠ‚ç‚¹æ³•ï¼‰

**æ€è·¯åˆ†æï¼š**

* è‹¥å¤´èŠ‚ç‚¹ç­‰äºç›®æ ‡å€¼ï¼Œéœ€è¦ä¸æ–­å‰ç§»ï¼›
* ä¹‹åç”¨ä¸¤ä¸ªæŒ‡é’ˆ `behind` ä¸ `temp` ç»´æŠ¤é“¾è¡¨ï¼›
* è‹¥ä¸­é—´èŠ‚ç‚¹å€¼ä¸º `val`ï¼Œè·³è¿‡å®ƒï¼Œå¦åˆ™ä¸¤æŒ‡é’ˆåŒæ—¶å‰ç§»ï¼›
* æœ€åå¤„ç†å°¾èŠ‚ç‚¹æ˜¯å¦åˆ é™¤ã€‚

**ä»£ç å®ç°ï¼š**

```cpp
class Solution {
public:
    ListNode* removeElements(ListNode* head, int val) {
        if (head == nullptr)
            return nullptr;

        // è·³è¿‡å‰å¯¼ç­‰äº val çš„èŠ‚ç‚¹
        while (head->val == val) {
            head = head->next;
            if (head == nullptr)
                return nullptr;
        }

        ListNode* temp = head->next;
        ListNode* behind = head;
        if (temp == nullptr)
            return head;

        // åˆ é™¤ä¸­é—´èŠ‚ç‚¹
        while (temp->next != nullptr) {
            if (temp->val == val) {
                temp = temp->next;
                behind->next = temp;
            } else {
                temp = temp->next;
                behind = behind->next;
            }
        }

        // å¤„ç†æœ€åä¸€ä¸ªèŠ‚ç‚¹
        if (temp->val == val)
            behind->next = nullptr;

        return head;
    }
};
```

**å¤æ‚åº¦åˆ†æï¼š**

* æ—¶é—´å¤æ‚åº¦ï¼šO(n)
* ç©ºé—´å¤æ‚åº¦ï¼šO(1)

---

#### 2.2.4 ä¸‰ç§å†™æ³•æ¯”è¾ƒ

| å¯¹æ¯”ç»´åº¦    | é€’å½’æ³•    | å®˜æ–¹è¿­ä»£æ³•     | æˆ‘çš„å®ç°    |
| ------- | ------ | --------- | ------- |
| åˆ é™¤å¤´èŠ‚ç‚¹æ–¹å¼ | é€’å½’è‡ªç„¶å¤„ç† | ä½¿ç”¨å“‘èŠ‚ç‚¹ç®€åŒ–   | æ‰‹åŠ¨å‰ç§»è·³è¿‡  |
| åˆ é™¤é€»è¾‘å®ç°  | é€šè¿‡å›æº¯åˆ¤æ–­ | æŒ‡é’ˆä¿®æ”¹ next | åŒæŒ‡é’ˆè·³è¿‡èŠ‚ç‚¹ |
| å¯è¯»æ€§     | ç®€æ´ä¼˜é›…   | æ¸…æ™°æ˜“ç»´æŠ¤     | è¾ƒç¹çä½†ç›´è§‚  |
| æ—¶é—´å¤æ‚åº¦   | O(n)   | O(n)      | O(n)    |
| ç©ºé—´å¤æ‚åº¦   | O(n)   | O(1)      | O(1)    |

---
### 2.2.5 é€’å½’ä¾‹é¢˜2
é¢˜å·ï¼š[LeetCode 24 - Swap Nodes in Pairs](https://leetcode.cn/problems/swap-nodes-in-pairs/) 
é¢˜æ„ï¼šä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ï¼Œå¹¶è¿”å›äº¤æ¢åçš„å¤´èŠ‚ç‚¹ã€‚
```cpp
 ListNode* swapPairs(ListNode* head) {
        if(head==nullptr||head->next==nullptr)
        return head;
        ListNode* newnode=head->next;
        head->next=swapPairs(newnode->next);
        newnode->next=head;
        return newnode;
    }
```
è¿™é“é¢˜ä¸å…¶ä»–é€’å½’ä¸åŒçš„æ˜¯ä»–çš„é€’å½’å¤„ç†åè¦è¿›è¡ŒèŠ‚ç‚¹äº¤æ¢æ“ä½œï¼Œé€’å½’çš„æ ¸å¿ƒæ€æƒ³ä¾ç„¶æ˜¯å°†å¤§é—®é¢˜åˆ†è§£ä¸ºå°é—®é¢˜ï¼Œå…ˆå¤„ç†åé¢çš„èŠ‚ç‚¹ï¼Œå†å›æº¯å¤„ç†å½“å‰èŠ‚ç‚¹çš„äº¤æ¢ã€‚
#### 2.2.6 æ€ç»´æ€»ç»“

1. é€’å½’çš„é­…åŠ›åœ¨äºï¼š**ä½ ä¸éœ€è¦åŒæ—¶è€ƒè™‘æ‰€æœ‰èŠ‚ç‚¹ï¼Œåªè¦ç›¸ä¿¡â€œå­é—®é¢˜å·²è§£å†³â€**ã€‚
2. æ¯ä¸€å±‚é€’å½’ä»…éœ€æ€è€ƒâ€œå½“å‰èŠ‚ç‚¹æ˜¯å¦ä¿ç•™â€ï¼Œè¿™è®©å¤æ‚æŒ‡é’ˆæ“ä½œå˜å¾—é€»è¾‘ç®€å•ã€‚
3. ä½†é€’å½’ä¹Ÿæœ‰å±€é™â€”â€”åœ¨æé•¿é“¾è¡¨ä¸­å¯èƒ½å¯¼è‡´æ ˆæº¢å‡ºï¼Œå› æ­¤é¢è¯•ä¸­å¸¸ç”¨è¿­ä»£æ³•ã€‚
4. ç†è§£è¿™é“é¢˜çš„é€’å½’æ€æƒ³ï¼Œæ˜¯è¿›å…¥é“¾è¡¨é«˜é˜¶é€’å½’é¢˜ï¼ˆå¦‚åè½¬ã€åˆå¹¶ï¼‰çš„åŸºç¡€ã€‚

---

### 2.3 é€’å½’çš„é€šç”¨æ¨¡æ¿

```cpp
è¿”å›ç±»å‹ å‡½æ•°å(å‚æ•°) {
    // 1. ç»ˆæ­¢æ¡ä»¶
    if (ç»ˆæ­¢æ¡ä»¶)
        return åŸºç¡€ç»“æœ;

    // 2. é€’å½’è°ƒç”¨
    å­é—®é¢˜ç»“æœ = å‡½æ•°å(å­é—®é¢˜å‚æ•°);

    // 3. åˆå¹¶ç»“æœ
    return å½“å‰ç»“æœä¸å­ç»“æœçš„ç»„åˆ;
}
```

---

### 2.4 é€’å½’çš„å¸¸è§åº”ç”¨æ–¹å‘

| æ¨¡å—       | ç¤ºä¾‹é¢˜ç›®                                                                 | è¯´æ˜         |
| -------- | -------------------------------------------------------------------- | ------------ |
| **é“¾è¡¨**   | [LeetCode 203 Â· ç§»é™¤é“¾è¡¨å…ƒç´ ](https://leetcode.cn/problems/remove-linked-list-elements/)ã€[LeetCode 206 Â· åè½¬é“¾è¡¨](https://leetcode.cn/problems/reverse-linked-list/) | æ“ä½œå¤©ç„¶é€’å½’ç»“æ„ |
| **æ ‘ç»“æ„**  | [LeetCode 104 Â· äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦](https://leetcode.cn/problems/maximum-depth-of-binary-tree/)ã€[LeetCode 94 Â· äºŒå‰æ ‘çš„ä¸­åºéå†](https://leetcode.cn/problems/binary-tree-inorder-traversal/) | å¤©ç”Ÿé€’å½’å®šä¹‰   |
| **åˆ†æ²»æ³•**  | [LeetCode 912 Â· æ’åºæ•°ç»„](https://leetcode.cn/problems/sort-an-array/)ï¼ˆå½’å¹¶/å¿«æ’ï¼‰ | æ‹†åˆ†å­åŒºé—´    |
| **å›æº¯æ³•**  | [LeetCode 46 Â· å…¨æ’åˆ—](https://leetcode.cn/problems/permutations/)ã€[LeetCode 39 Â· ç»„åˆæ€»å’Œ](https://leetcode.cn/problems/combination-sum/) | æšä¸¾æœç´¢ç©ºé—´   |
| **æ•°å­¦é€’æ¨** | [LeetCode 509 Â· æ–æ³¢é‚£å¥‘æ•°](https://leetcode.cn/problems/fibonacci-number/)ã€[LeetCode 70 Â· çˆ¬æ¥¼æ¢¯](https://leetcode.cn/problems/climbing-stairs/) | è‡ªç„¶æ•°å­¦å®šä¹‰   |

---

### 2.5 å°ç»“

* **é€’å½’æ€æƒ³æœ¬è´¨ï¼š** â€œç”¨å‡½æ•°è°ƒç”¨è‡ªèº«â€ä»¥ç®€åŒ–é—®é¢˜ã€‚
* **é“¾è¡¨é€’å½’ç²¾åï¼š** åˆ©ç”¨å›æº¯é˜¶æ®µè‡ªç„¶ä¿®æ”¹æŒ‡é’ˆã€‚
* **å­¦ä¹ å»ºè®®ï¼š** å…ˆä»â€œç§»é™¤é“¾è¡¨å…ƒç´ â€â€œåè½¬é“¾è¡¨â€ç­‰å…¥æ‰‹ï¼Œå†æ‰©å±•åˆ°äºŒå‰æ ‘é€’å½’ã€‚
é€’å½’çš„é­…åŠ›åœ¨äºæŠ½è±¡æ€ç»´ï¼šä½ ä¸éœ€è¦çŸ¥é“â€œä¸‹ä¸€æ­¥æ€ä¹ˆèµ°â€ï¼Œåªéœ€ç›¸ä¿¡â€œå­é—®é¢˜å·²ç»è¢«è§£å†³â€ã€‚
è¿™æ˜¯ç®—æ³•æ€ç»´ä¸­æœ€æ¥è¿‘â€œè‡ªæˆ‘å¤åˆ¶é€»è¾‘â€çš„ä¸€ç¯â€”â€”ä¸€ç§é€»è¾‘ä¸Šçš„é€’å½’ä¼˜é›…ã€‚

---
## 3. å•é“¾è¡¨æ ¸å¿ƒå‡½æ•°è¯¦è§£

 ä»¥ä¸‹å†…å®¹åŸºäºå®˜æ–¹é¢˜è§£ä»£ç ï¼ˆå‚è€ƒ [LeetCode 707 - è®¾è®¡é“¾è¡¨](https://leetcode.cn/problems/design-linked-list/)ï¼‰ã€‚  

---

### 3.1 æ„é€ å‡½æ•° `MyLinkedList()`

```cpp
MyLinkedList() {
    this->size = 0;
    this->head = new ListNode(0); // åˆ›å»ºå“¨å…µèŠ‚ç‚¹
}
```

#### åŠŸèƒ½è§£æï¼š

åˆå§‹åŒ–é“¾è¡¨ã€‚

* `size` è®°å½•å½“å‰èŠ‚ç‚¹æ•°é‡ï¼›
* `head` æŒ‡å‘å“¨å…µèŠ‚ç‚¹ï¼ˆdummy headï¼‰ï¼Œé¿å…ç©ºé“¾è¡¨æ—¶æ’å…¥/åˆ é™¤é€»è¾‘çš„ç‰¹æ®Šåˆ¤æ–­ã€‚
> ![é“¾è¡¨åˆå§‹åŒ–ç¤ºæ„å›¾](pic/1_1.png)

---

### 3.2 è·å–èŠ‚ç‚¹ `get(int index)`

```cpp
int get(int index) {
    if (index < 0 || index >= size) {
        return -1;
    }
    ListNode *cur = head;
    for (int i = 0; i <= index; i++) {
        cur = cur->next;
    }
    return cur->val;
}
```

#### åŠŸèƒ½è§£æï¼š

çº¿æ€§éå†é“¾è¡¨ï¼Œè·å–ç¬¬ `index` ä¸ªèŠ‚ç‚¹çš„å€¼ã€‚
ç”±äºé“¾è¡¨æ²¡æœ‰éšæœºè®¿é—®èƒ½åŠ›ï¼Œå¿…é¡»ä»å¤´èŠ‚ç‚¹å¼€å§‹ç§»åŠ¨æŒ‡é’ˆã€‚

#### æ—¶é—´å¤æ‚åº¦ï¼š

O(n)

> ![getå‡½æ•°éå†ç¤ºæ„å›¾](pic/1_2.png)

---

### 3.3 å¤´æ’æ³• `addAtHead(int val)`

```cpp
void addAtHead(int val) {
    addAtIndex(0, val);
}
```

#### åŠŸèƒ½è§£æï¼š
åœ¨é“¾è¡¨å¤´éƒ¨ï¼ˆå“¨å…µèŠ‚ç‚¹åï¼‰æ’å…¥æ–°èŠ‚ç‚¹ã€‚
æœ¬è´¨ä¸Šæ˜¯è°ƒç”¨ `addAtIndex(0, val)`ã€‚


### 3.4 å°¾æ’æ³• `addAtTail(int val)`

```cpp
void addAtTail(int val) {
    addAtIndex(size, val);
}
```
#### åŠŸèƒ½è§£æï¼š

åœ¨é“¾è¡¨å°¾éƒ¨æ’å…¥èŠ‚ç‚¹ã€‚
ç”±äºæ²¡æœ‰ `tail` æŒ‡é’ˆï¼Œéœ€è¦ä»å¤´éå†è‡³å°¾ã€‚

---

### 3.5 æŒ‡å®šä½ç½®æ’å…¥ `addAtIndex(int index, int val)`

```cpp
void addAtIndex(int index, int val) {
    if (index > size) {
        return;
    }
    index = max(0, index);
    size++;
    ListNode *pred = head;
    for (int i = 0; i < index; i++) {
        pred = pred->next;
    }
    ListNode *toAdd = new ListNode(val);
    toAdd->next = pred->next;
    pred->next = toAdd;
}
```

#### åŠŸèƒ½è§£æï¼š

1. æ£€æŸ¥æ’å…¥ä½ç½®æ˜¯å¦åˆæ³•ï¼›
2. éå†åˆ°æ’å…¥ç‚¹çš„**å‰é©±èŠ‚ç‚¹**ï¼›
3. æ‰§è¡ŒæŒ‡é’ˆäº¤æ¢ï¼Œå®ç°æ’å…¥ï¼›
4. æ›´æ–°é“¾è¡¨é•¿åº¦ã€‚

#### å…³é”®ç‚¹ï¼š

* æ’å…¥åˆ° `index == size` æ—¶ç­‰ä»·äºå°¾æ’ï¼›
* æ’å…¥åˆ° `index == 0` æ—¶ç­‰ä»·äºå¤´æ’ï¼›
* ç”¨ `pred` è®°å½•å‰é©±èŠ‚ç‚¹ï¼Œç¡®ä¿æ“ä½œå®‰å…¨ã€‚
> ![addAtIndexæ’å…¥æŒ‡é’ˆè°ƒæ•´å›¾](pic/1_3.png)

---

### 3.6 åˆ é™¤èŠ‚ç‚¹ `deleteAtIndex(int index)`

```cpp
void deleteAtIndex(int index) {
    if (index < 0 || index >= size) {
        return;
    }
    size--;
    ListNode *pred = head;
    for (int i = 0; i < index; i++) {
        pred = pred->next;
    }
    ListNode *p = pred->next;
    pred->next = pred->next->next;
    delete p;
}
```

#### åŠŸèƒ½è§£æï¼š

1. æ£€æŸ¥åˆ é™¤ä½ç½®æ˜¯å¦åˆæ³•ï¼›
2. éå†åˆ°è¢«åˆ èŠ‚ç‚¹çš„å‰é©±ï¼›
3. è°ƒæ•´æŒ‡é’ˆï¼Œä½¿ç›®æ ‡èŠ‚ç‚¹è¢«â€œè·³è¿‡â€ï¼›
4. é‡Šæ”¾å†…å­˜ã€‚

#### å…³é”®ç‚¹ï¼š

* è‹¥åˆ é™¤ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œ`pred` å³ä¸ºå“¨å…µèŠ‚ç‚¹ï¼›
* `delete p;` é˜²æ­¢å†…å­˜æ³„æ¼ã€‚
> ![deleteAtIndexåˆ é™¤èŠ‚ç‚¹ç¤ºæ„å›¾](pic/1_4.png)

---

### 3.7 å°ç»“

é“¾è¡¨çš„æ ¸å¿ƒæ“ä½œæœ¬è´¨éƒ½æ˜¯å¯¹â€œæŒ‡é’ˆæŒ‡å‘â€çš„ç²¾ç¡®æ§åˆ¶ã€‚
ç†è§£â€œå‰é©±èŠ‚ç‚¹ï¼ˆpredï¼‰â€ä¸â€œå½“å‰èŠ‚ç‚¹ï¼ˆcurï¼‰â€çš„å…³ç³»ï¼Œæ˜¯ç¼–å†™æ—  bug é“¾è¡¨ä»£ç çš„å…³é”®ã€‚
åœ¨é“¾è¡¨æ“ä½œä¸­ï¼Œ**ä¸€è¡ŒæŒ‡é’ˆäº¤æ¢ä»£ç å¾€å¾€æ˜¯é€»è¾‘æ ¸å¿ƒ**ã€‚

---

## 4. åŒæŒ‡é’ˆä¸“é¢˜å®Œæ•´æ€»ç»“ï¼šé“¾è¡¨ã€æ•°ç»„åˆ°æ»‘åŠ¨çª—å£çš„å…¨ä½“ç³»

åŒæŒ‡é’ˆå¹¶ä¸åªæ˜¯ä¸€ç§æŠ€å·§ï¼Œè€Œæ˜¯ä¸€å¥—å¤„ç†â€œç›¸å¯¹å…³ç³»â€çš„æ€æƒ³ä½“ç³»ï¼š
æŒ‡é’ˆä¹‹é—´çš„**é—´è·å…³ç³»**ã€**é€Ÿåº¦å…³ç³»**ã€**æ–¹å‘å…³ç³»**éƒ½ä¼šæˆä¸ºä¿¡æ¯æœ¬èº«ã€‚
å®ƒåœ¨é“¾è¡¨ä¸­ç”¨äºç»“æ„åˆ†æï¼Œåœ¨æ•°ç»„ä¸­ç”¨äºé«˜æ•ˆæœç´¢ï¼Œåœ¨å­—ç¬¦ä¸²ä¸­ç”¨äºåŠ¨æ€çª—å£ç»´æŠ¤ã€‚

æœ¬ä¸“é¢˜æ€»ç»“äº”ç±»ä»£è¡¨æ€§é¢˜ç›®ï¼š

* é“¾è¡¨å›ºå®šé—´è·ï¼šåˆ é™¤é“¾è¡¨å€’æ•°ç¬¬ N ä¸ªèŠ‚ç‚¹
* é“¾è¡¨å¿«æ…¢æŒ‡é’ˆï¼šç¯å…¥å£
* æ•°ç»„å·¦å³å¤¹é€¼ï¼šå››æ•°ä¹‹å’Œ
* æ•°ç»„åŒºé—´æ”¶ç¼©ï¼šæ¥é›¨æ°´
* æ»‘åŠ¨çª—å£ï¼šæœ€é•¿æ— é‡å¤å­ä¸²

---

### 4.1 åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬ N ä¸ªèŠ‚ç‚¹

é¢˜ç›®é“¾æ¥ï¼š
[https://leetcode.cn/problems/remove-nth-node-from-end-of-list/](https://leetcode.cn/problems/remove-nth-node-from-end-of-list/)

#### æ€è·¯

å›ºå®šé—´è·åŒæŒ‡é’ˆï¼š
è®© `first` æŒ‡é’ˆå…ˆèµ° n æ­¥ï¼Œå†è®© `first`ã€`second` åŒæ—¶èµ°ã€‚
å½“ `first` åˆ°è¾¾é“¾å°¾æ—¶ï¼Œ`second` æ­£å¥½åœ¨å€’æ•°ç¬¬ n ä¸ªèŠ‚ç‚¹çš„å‰ä¸€ä¸ªä½ç½®ã€‚

#### ä»£ç 

```cpp
class Solution {
public:
    ListNode* removeNthFromEnd(ListNode* head, int n) {
        ListNode* dummy = new ListNode(0, head);
        ListNode* first = head;
        ListNode* second = dummy;

        for (int i = 0; i < n; ++i) 
            first = first->next;

        while (first) {
            first = first->next;
            second = second->next;
        }

        second->next = second->next->next;
        ListNode* ans = dummy->next;
        delete dummy;
        return ans;
    }
};
```

---

### 4.2 ç¯å½¢é“¾è¡¨ IIï¼šç¯å…¥å£å®šä½ï¼ˆå¿«æ…¢æŒ‡é’ˆæ³•ï¼‰

é¢˜ç›®é“¾æ¥ï¼š
[https://leetcode.cn/problems/linked-list-cycle-ii/](https://leetcode.cn/problems/linked-list-cycle-ii/)

#### æ€è·¯

Floyd åˆ¤åœˆç®—æ³•æ ¸å¿ƒï¼š

* å¿«æŒ‡é’ˆæ¯æ¬¡èµ° 2 æ­¥
* æ…¢æŒ‡é’ˆæ¯æ¬¡èµ° 1 æ­¥
  è‹¥ç›¸é‡ï¼Œåˆ™è¯æ˜å­˜åœ¨ç¯ã€‚
  ç›¸é‡åï¼Œè®©ä¸€ä¸ªæ–°æŒ‡é’ˆä»å¤´å¼€å§‹èµ°ï¼Œä¸ `slow` åŒé€Ÿå‰è¿›ï¼Œä¸¤è€…å†æ¬¡ç›¸é‡çš„ä½ç½®å°±æ˜¯å…¥å£ã€‚

#### ä»£ç 

```cpp
class Solution {
public:
    ListNode* detectCycle(ListNode* head) {
        ListNode *fast = head, *slow = head;

        while (fast && fast->next) {
            fast = fast->next->next;
            slow = slow->next;
            if (fast == slow) break;
        }

        if (!fast || !fast->next) return NULL;

        ListNode* ptr = head;
        while (ptr != slow) {
            ptr = ptr->next;
            slow = slow->next;
        }
        return ptr;
    }
};
```

---

### 4.3 å››æ•°ä¹‹å’Œï¼šæ’åº + å·¦å³åŒæŒ‡é’ˆ

é¢˜ç›®é“¾æ¥ï¼š
[https://leetcode.cn/problems/4sum/](https://leetcode.cn/problems/4sum/)

#### æ€è·¯

* å…ˆæ’åº
* å¤–å±‚ä¸¤é‡å¾ªç¯å›ºå®šå‰ä¸¤ä¸ªæ•°
* å†…å±‚åŒæŒ‡é’ˆ `third`ã€`forst` é€šè¿‡å¤¹é€¼æ³•é€¼è¿‘ target
* åŠ ä¸Šå‰ªæå’Œå»é‡ä¼˜åŒ–

#### ä»£ç 

```cpp
class Solution {
public:
    vector<vector<int>> fourSum(vector<int>& nums, int target) {
        vector<vector<int>> ans;
        int n = nums.size();
        if (n < 4) return ans;

        sort(nums.begin(), nums.end());

        for (int first = 0; first < n - 3; first++) {
            if (first > 0 && nums[first] == nums[first - 1]) continue;
            if ((long)nums[first] + nums[first+1] + nums[first+2] + nums[first+3] > target) break;
            if ((long)nums[first] + nums[n-1] + nums[n-2] + nums[n-3] < target) continue;

            for (int second = first + 1; second < n - 2; second++) {
                if (second > first + 1 && nums[second] == nums[second - 1]) continue;
                if ((long)nums[first] + nums[second] + nums[second+1] + nums[second+2] > target) break;
                if ((long)nums[first] + nums[second] + nums[n-1] + nums[n-2] < target) continue;

                int third = second + 1, forst = n - 1;
                while (third < forst) {
                    long sum = (long)nums[first] + nums[second] + nums[third] + nums[forst];
                    if (sum < target) third++;
                    else if (sum > target) forst--;
                    else {
                        ans.push_back({nums[first], nums[second], nums[third], nums[forst]});
                        while (third < forst && nums[third] == nums[third+1]) third++;
                        while (third < forst && nums[forst] == nums[forst-1]) forst--;
                        third++; 
                        forst--;
                    }
                }
            }
        }
        return ans;
    }
};
```

---

### 4.4 æ¥é›¨æ°´ï¼šåŒæŒ‡é’ˆçš„åŒºé—´æ”¶ç¼©

é¢˜ç›®é“¾æ¥ï¼š
[https://leetcode.cn/problems/trapping-rain-water/](https://leetcode.cn/problems/trapping-rain-water/)

#### æ€è·¯

æ ¸å¿ƒæ€æƒ³ï¼š
æ°´çš„é«˜åº¦ç”±å·¦å³ä¸¤ä¾§çš„æœ€å¤§é«˜åº¦å†³å®šã€‚
å·¦å³æŒ‡é’ˆå‘ä¸­é—´æ”¶ç¼©æ—¶ï¼Œå¯ä»¥ä¿è¯å½“å‰è¢«å¤„ç†çš„ä¸€ä¾§ï¼Œå…¶å†…ä¾§æœ€å¤§å€¼æ˜¯å¯ä¿¡çš„ã€‚

è§„åˆ™ï¼š

* å¦‚æœ `left_max < right_max`ï¼Œå·¦ä¾§å†³å®šæ°´é‡ -> left++
* å¦åˆ™å³ä¾§å†³å®šæ°´é‡ -> right--

#### ä»£ç 

```cpp
class Solution {
public:
    int trap(vector<int>& height) {
        int left = 0, right = height.size() - 1;
        int left_max = 0, right_max = 0, ans = 0;

        while (left < right) {
            if (height[left] < height[right]) {
                if (height[left] >= left_max)
                    left_max = height[left];
                else
                    ans += left_max - height[left];
                left++;
            } else {
                if (height[right] >= right_max)
                    right_max = height[right];
                else
                    ans += right_max - height[right];
                right--;
            }
        }

        return ans;
    }
};
```

---

### 4.5 æœ€é•¿æ— é‡å¤å­ä¸²ï¼šæ»‘åŠ¨çª—å£ï¼ˆå­—ç¬¦ä¸²åŒæŒ‡é’ˆï¼‰

é¢˜ç›®é“¾æ¥ï¼š
[https://leetcode.cn/problems/longest-substring-without-repeating-characters/](https://leetcode.cn/problems/longest-substring-without-repeating-characters/)

#### æ€è·¯

â€œæ»‘åŠ¨çª—å£â€æœ¬è´¨å°±æ˜¯åŒæŒ‡é’ˆï¼š

* `right` æ‰©å¼ çª—å£
* å½“çª—å£ä¸­å‡ºç°é‡å¤å­—ç¬¦æ—¶ï¼Œ`left` æ”¶ç¼©çª—å£
  ç”¨ä¸€ä¸ªæ•°ç»„æˆ– map è®°å½•å­—ç¬¦å‡ºç°çš„ä½ç½®ï¼Œå®ç°åŠ¨æ€è°ƒæ•´çª—å£ã€‚

#### ä»£ç 

```cpp
class Solution {
public:
    int lengthOfLongestSubstring(string s) {
        vector<int> last(256, -1);
        int left = 0, ans = 0;

        for (int right = 0; right < s.size(); right++) {
            if (last[s[right]] >= left) {
                left = last[s[right]] + 1;
            }
            last[s[right]] = right;
            ans = max(ans, right - left + 1);
        }
        return ans;
    }
};
```

---

### 4.6 æ€»ä½“æ–¹æ³•æ€»ç»“

é“¾è¡¨ç±»é—®é¢˜ï¼š
åŒæŒ‡é’ˆåˆ©ç”¨çš„æ˜¯â€œç»“æ„å…³ç³»â€

* å›ºå®šé—´è·ï¼šå®šä½å€’æ•°èŠ‚ç‚¹
* é€Ÿåº¦å·®ï¼šæ£€æµ‹ç¯ã€å¯»æ‰¾ç¯å…¥å£

æ•°ç»„ç±»é—®é¢˜ï¼ˆæ’åºåï¼‰ï¼š
åŒæŒ‡é’ˆåˆ©ç”¨çš„æ˜¯â€œå•è°ƒæ€§ + åŒºé—´æ”¶ç¼©â€

* å·¦å³å¤¹é€¼ï¼ˆæ±‚å’Œç±»ï¼Œå¦‚ 2Sum/3Sum/4Sumï¼‰
* ç»“æ„æ€§å¤¹é€¼ï¼ˆæ¥é›¨æ°´ï¼‰

å­—ç¬¦ä¸²æ»‘åŠ¨çª—å£ï¼š
åŒæŒ‡é’ˆåˆ©ç”¨çš„æ˜¯â€œåŠ¨æ€çª—å£ + ä¿¡æ¯è®°å½•â€

* æœ€é•¿æ— é‡å¤å­ä¸²
* æœ€é•¿åŒ…å« K ä¸ªä¸åŒå­—ç¬¦å­ä¸²
* æœ€å°è¦†ç›–å­ä¸²

åŒæŒ‡é’ˆçš„æœ¬è´¨åœ¨äºï¼š
**ç”¨ä¸¤ä¸ªç§»åŠ¨çš„è¾¹ç•Œæ„é€ ä¿¡æ¯ï¼Œé€šè¿‡å…³ç³»å˜åŒ–æ¥å‡å°‘æ— æ•ˆæœç´¢**ã€‚
æŒæ¡è¿™å¥—ä½“ç³»ï¼Œå°±èƒ½åœ¨é“¾è¡¨ã€æ•°ç»„ã€å­—ç¬¦ä¸²çš„ä¼—å¤šæ ¸å¿ƒé¢˜ç›®ä¸­è‡ªç”±ç©¿æ¢­ã€‚

---


## 5. å‰ç¼€å’Œä¸å¤šç»´å‰ç¼€å’Œ

### 5.1 ä¸€ç»´å‰ç¼€å’Œï¼ˆåŒºé—´å’Œé—®é¢˜ï¼‰

#### 5.1.1 é—®é¢˜èƒŒæ™¯

ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ `Array`ï¼Œéœ€è¦å¿«é€Ÿæ±‚ä»»æ„åŒºé—´ `[l, r]` å†…æ‰€æœ‰å…ƒç´ çš„å’Œã€‚

æœ€æœ´ç´ çš„åšæ³•æ˜¯æ¯æ¬¡éå†æ±‚å’Œï¼Œæ—¶é—´å¤æ‚åº¦ä¸º `O(n*q)`ï¼ˆq ä¸ºæŸ¥è¯¢æ¬¡æ•°ï¼‰ï¼Œæ˜¾ç„¶åœ¨å¤šæ¬¡æŸ¥è¯¢æ—¶æ•ˆç‡ä½ã€‚
å‰ç¼€å’Œï¼ˆPrefix Sumï¼‰æ˜¯ä¸€ç§é¢„å¤„ç†æ€æƒ³ï¼Œèƒ½å°†**åŒºé—´æ±‚å’Œ**çš„æ—¶é—´å¤æ‚åº¦ä» O(n) é™åˆ° **O(1)**ã€‚

#### 5.1.2 å®šä¹‰ä¸å…¬å¼

å®šä¹‰å‰ç¼€å’Œæ•°ç»„ `pre[i]` è¡¨ç¤ºå‰ `i` ä¸ªå…ƒç´ çš„æ€»å’Œï¼š
$$
pre[i] = a_1 + a_2 + \cdots + a_i
$$

åˆ™ä»»æ„åŒºé—´ `[l, r]` çš„å’Œå¯ç”±å‰ç¼€å·®å¾—åˆ°ï¼š
$$
sum(l, r) = pre[r] - pre[l - 1]
$$

å…¶ä¸­ `pre[0] = 0`ï¼Œç”¨äºå¤„ç†è¾¹ç•Œã€‚

#### 5.1.3 æ—¶é—´å¤æ‚åº¦åˆ†æ

* æ„å»ºå‰ç¼€å’Œï¼šO(n)
* å•æ¬¡åŒºé—´æ±‚å’Œï¼šO(1)
* æ€»ä½“å¤æ‚åº¦ï¼šO(n + q)

#### 5.1.4 ç¤ºä¾‹ä»£ç 

```cpp
#include <iostream>
#include <vector>
using namespace std;

int main() {
    int n, q;
    cin >> n;
    vector<int> a(n + 1), pre(n + 1, 0);
    for (int i = 1; i <= n; i++) cin >> a[i];
    
    // æ„å»ºå‰ç¼€å’Œ
    for (int i = 1; i <= n; i++) pre[i] = pre[i - 1] + a[i];
    
    cin >> q;
    while (q--) {
        int l, r;
        cin >> l >> r;
        cout << pre[r] - pre[l - 1] << endl;
    }
}
```

---

### 5.2 äºŒç»´å‰ç¼€å’Œï¼ˆå¼€å‘å•†è´­ä¹°åœŸåœ°é—®é¢˜ï¼‰

#### 5.2.1 é—®é¢˜èƒŒæ™¯

åœ¨ä¸€ä¸ª `n Ã— m` çš„çŸ©é˜µä¸­ï¼Œæ¯ä¸ªæ ¼å­æœ‰ä¸€ä¸ªæƒå€¼ï¼Œä»£è¡¨åœŸåœ°ä»·å€¼ã€‚
è¦åœ¨ä¸€æ¡**æ¨ªçº¿**æˆ–**ç«–çº¿**ä¸Šå°†åŸå¸‚åŒºåŸŸåˆ’åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œä½¿å¾—ä¸¤éƒ¨åˆ†çš„æ€»å’Œå·®æœ€å°ã€‚

ç”±äºçŸ©é˜µæ•°æ®è¾ƒå¤§ï¼Œç›´æ¥æšä¸¾å­çŸ©é˜µä¼šè¶…æ—¶ï¼Œéœ€è¦ä½¿ç”¨**äºŒç»´å‰ç¼€å’Œ**å¿«é€Ÿæ±‚ä»»æ„çŸ©å½¢åŒºåŸŸçš„å’Œã€‚

---

#### 5.2.2 äºŒç»´å‰ç¼€å’Œå®šä¹‰

å®šä¹‰ `pre[i][j]` ä¸ºä»å·¦ä¸Šè§’ `(1, 1)` åˆ° `(i, j)` çš„çŸ©å½¢åŒºåŸŸçš„æ‰€æœ‰å…ƒç´ ä¹‹å’Œï¼š
$$
pre[i][j] = pre[i-1][j] + pre[i][j-1] - pre[i-1][j-1] + a[i][j]
$$

ä»»æ„å­çŸ©å½¢ `(x1, y1)` åˆ° `(x2, y2)` çš„å’Œä¸ºï¼š
$$
sum = pre[x2][y2] - pre[x1-1][y2] - pre[x2][y1-1] + pre[x1-1][y1-1]
$$

---

#### 5.2.3 åˆ‡å‰²æ€è·¯

ç”±äºé¢˜ç›®åªå…è®¸**ä¸€åˆ€åˆ‡**ï¼ˆæ¨ªæˆ–ç«–ï¼‰ï¼Œæˆ‘ä»¬åªéœ€æšä¸¾åˆ‡å‰²çº¿ï¼š

* **æ¨ªå‘åˆ‡å‰²**ï¼šåœ¨ç¬¬ i è¡Œå’Œç¬¬ i+1 è¡Œä¹‹é—´åˆ‡
  ä¸Šæ–¹å’Œä¸º `pre[i][m]`ï¼Œä¸‹æ–¹å’Œä¸º `total - pre[i][m]`
* **çºµå‘åˆ‡å‰²**ï¼šåœ¨ç¬¬ j åˆ—å’Œç¬¬ j+1 åˆ—ä¹‹é—´åˆ‡
  å·¦æ–¹å’Œä¸º `pre[n][j]`ï¼Œå³æ–¹å’Œä¸º `total - pre[n][j]`

å·®å€¼ä¸ºï¼š
$$
diff = |S_1 - S_2|
$$

æšä¸¾è¡Œ/åˆ—æ±‚æœ€å°å·®å€¼å³å¯ã€‚

---

#### 5.2.4 æ—¶é—´å¤æ‚åº¦åˆ†æ

* æ„å»ºäºŒç»´å‰ç¼€å’Œï¼šO(n*m)
* æšä¸¾è¡Œåˆ‡å‰²ï¼šO(n)
* æšä¸¾åˆ—åˆ‡å‰²ï¼šO(m)

æ€»å¤æ‚åº¦ï¼š**O(n*m)**ï¼Œåœ¨ n, m â‰¤ 100 æ—¶æå¿«ã€‚

---

#### 5.2.5 ç¤ºä¾‹ä»£ç 

```cpp
#include <iostream>
#include <vector>
#include <cmath>
using namespace std;

int main() {
    int n, m;
    cin >> n >> m;
    vector<vector<int>> a(n + 1, vector<int>(m + 1, 0));
    vector<vector<int>> pre(n + 1, vector<int>(m + 1, 0));

    for (int i = 1; i <= n; ++i)
        for (int j = 1; j <= m; ++j)
            cin >> a[i][j];

    // æ„å»ºäºŒç»´å‰ç¼€å’Œ
    for (int i = 1; i <= n; ++i)
        for (int j = 1; j <= m; ++j)
            pre[i][j] = pre[i - 1][j] + pre[i][j - 1] - pre[i - 1][j - 1] + a[i][j];

    int total = pre[n][m];
    int ans = 1e9;

    // æ¨ªå‘åˆ‡å‰²
    for (int i = 1; i < n; ++i) {
        int up = pre[i][m];
        int down = total - up;
        ans = min(ans, abs(up - down));
    }

    // çºµå‘åˆ‡å‰²
    for (int j = 1; j < m; ++j) {
        int left = pre[n][j];
        int right = total - left;
        ans = min(ans, abs(left - right));
    }

    cout << ans << endl;
    return 0;
}
```
---
#### 5.2.6 æ€æƒ³å°ç»“

* **å‰ç¼€å’Œ**æ˜¯ä¸€ç§å…¸å‹çš„â€œä»¥ç©ºé—´æ¢æ—¶é—´â€çš„ç®—æ³•æ€æƒ³ã€‚
* **ä¸€ç»´å‰ç¼€å’Œ**é€‚ç”¨äºåŒºé—´æ±‚å’Œã€‚
* **äºŒç»´å‰ç¼€å’Œ**å°†è¿™ç§æ€æƒ³æ¨å¹¿åˆ°çŸ©é˜µæ±‚å’Œï¼Œä½¿å¾—å­åŒºåŸŸæŸ¥è¯¢å˜ä¸º O(1)ã€‚
* è¿™ç±»é¢˜çš„æœ¬è´¨æ˜¯ï¼š**å‡å°‘é‡å¤è®¡ç®—ï¼Œå¿«é€Ÿè·å¾—ä»»æ„åŒºåŸŸçš„ç´¯ç§¯ä¿¡æ¯**ã€‚



---

## 6. å“ˆå¸Œè¡¨ä¸é›†åˆå®¹å™¨ç”¨æ³•æ€»ç»“

### 6.1 `unordered_map<Key, Value>` â€”â€” æ— åºå“ˆå¸Œæ˜ å°„

åº•å±‚ç»“æ„ä¸ºå“ˆå¸Œè¡¨ï¼Œé”®ï¼ˆkeyï¼‰å”¯ä¸€ï¼Œå¯¹åº”ä¸€ä¸ªå€¼ï¼ˆvalueï¼‰ã€‚
å¹³å‡æŸ¥æ‰¾ã€æ’å…¥å¤æ‚åº¦ä¸º **O(1)**ã€‚

#### åŸºæœ¬ç”¨æ³•

```cpp
unordered_map<int, int> mp;
unordered_map<string, double> score;
```

#### æ’å…¥å…ƒç´ 

```cpp
mp[3] = 10;                        // ç›´æ¥èµ‹å€¼æ’å…¥
mp.insert({5, 20});                // èŠ±æ‹¬å·æ’å…¥
mp.insert(make_pair(7, 30));       // make_pairæ’å…¥
```

#### æŸ¥æ‰¾ä¸è®¿é—®

```cpp
auto it = mp.find(3);              // æŸ¥æ‰¾é”®ä¸º3çš„å…ƒç´ 
if (it != mp.end())
    cout << it->second;            // è®¿é—®å¯¹åº”çš„value
```

#### åˆ¤æ–­é”®æ˜¯å¦å­˜åœ¨

```cpp
if (mp.count(3))
    cout << "å­˜åœ¨";
else
    cout << "ä¸å­˜åœ¨";
```

#### åˆ é™¤ä¸æ¸…ç©º

```cpp
mp.erase(3);                       // åˆ é™¤é”®ä¸º3çš„å…ƒç´ 
mp.clear();                        // æ¸…ç©ºæ•´ä¸ªå“ˆå¸Œè¡¨
```

#### éå†

```cpp
for (auto &p : mp)
    cout << p.first << " " << p.second << endl;
```

#### ç‰¹ç‚¹è¯´æ˜

* é”®å”¯ä¸€ï¼Œé‡å¤æ’å…¥ä¼šè¦†ç›–æ—§å€¼ï¼›
* æ— åºå­˜å‚¨ï¼Œéå†é¡ºåºä¸å¯é¢„æµ‹ï¼›
* è®¿é—®ä¸å­˜åœ¨çš„é”®ï¼ˆå¦‚ `mp[x]`ï¼‰ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªé»˜è®¤å€¼ã€‚

---

### 6.2 `map<Key, Value>` â€”â€” æœ‰åºæ˜ å°„è¡¨

åº•å±‚ç»“æ„ä¸ºçº¢é»‘æ ‘ï¼Œé”®è‡ªåŠ¨æ’åºã€‚
æŸ¥æ‰¾ã€æ’å…¥å¤æ‚åº¦ä¸º **O(log n)**ã€‚

#### åŸºæœ¬ç”¨æ³•

```cpp
map<int, int> mp;
```

#### æ’å…¥ä¸è®¿é—®

```cpp
mp[3] = 10;
mp.insert({5, 20});
cout << mp[3];                     // è¾“å‡ºvalue
```

#### éå†ï¼ˆè‡ªåŠ¨å‡åºï¼‰

```cpp
for (auto &p : mp)
    cout << p.first << " " << p.second << endl;
```

#### ç‰¹ç‚¹è¯´æ˜

* é”®å”¯ä¸€ï¼›
* é”®è‡ªåŠ¨æŒ‰å‡åºæ’åˆ—ï¼›
* å¯é€šè¿‡è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°å®ç°é™åºæˆ–å…¶ä»–æ’åºæ–¹å¼ã€‚

---

### 6.3 `unordered_set<Type>` â€”â€” æ— åºå“ˆå¸Œé›†åˆ

åº•å±‚ä¸ºå“ˆå¸Œè¡¨ï¼Œåªå­˜é”®ï¼ˆkeyï¼‰ï¼Œä¸å­˜å€¼ã€‚
å¹³å‡æŸ¥æ‰¾ã€æ’å…¥å¤æ‚åº¦ä¸º **O(1)**ã€‚

#### åŸºæœ¬ç”¨æ³•

```cpp
unordered_set<int> s;
unordered_set<string> names;
```

#### æ’å…¥å…ƒç´ 

```cpp
s.insert(3);
s.insert(5);
```

#### æŸ¥æ‰¾ä¸åˆ¤æ–­

```cpp
if (s.find(3) != s.end())
    cout << "æ‰¾åˆ°";
if (s.count(3))
    cout << "å­˜åœ¨";
```

#### åˆ é™¤ä¸éå†

```cpp
s.erase(3);
for (auto &x : s)
    cout << x << " ";
```

#### ç‰¹ç‚¹è¯´æ˜

* æ— åºå­˜å‚¨ï¼›
* å…ƒç´ å”¯ä¸€ï¼›
* æ’å…¥é‡å¤å…ƒç´ æ— æ•ˆã€‚

---

### 6.4 `set<Type>` â€”â€” æœ‰åºé›†åˆ

åº•å±‚ä¸ºçº¢é»‘æ ‘ç»“æ„ï¼Œå…ƒç´ è‡ªåŠ¨æ’åºã€‚
æŸ¥æ‰¾ã€æ’å…¥å¤æ‚åº¦ä¸º **O(log n)**ã€‚

#### åŸºæœ¬ç”¨æ³•

```cpp
set<int> s;
```

#### æ’å…¥ä¸éå†

```cpp
s.insert(3);
s.insert(1);
s.insert(5);

for (auto &x : s)
    cout << x << " ";              // è¾“å‡ºï¼š1 3 5
```

#### æŸ¥æ‰¾ä¸åˆ é™¤

```cpp
if (s.find(3) != s.end())
    cout << "æ‰¾åˆ°";

s.erase(3);
```

#### ç‰¹ç‚¹è¯´æ˜

* è‡ªåŠ¨å»é‡ï¼›
* å…ƒç´ æœ‰åºï¼ˆé»˜è®¤å‡åºï¼‰ï¼›
* å¯è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°å®ç°é™åºã€‚

---

### 6.5 å››ç§å¸¸è§å®¹å™¨å¯¹æ¯”

| å®¹å™¨ç±»å‹            | æ˜¯å¦æœ‰åº | åº•å±‚ç»“æ„ | æ˜¯å¦å…è®¸é‡å¤é”® | æŸ¥æ‰¾/æ’å…¥å¤æ‚åº¦ | æ˜¯å¦å¯è‡ªå®šä¹‰æ’åº |
| --------------- | ---- | ---- | ------- | -------- | -------- |
| `unordered_map` | å¦    | å“ˆå¸Œè¡¨  | å¦       | å¹³å‡ O(1)  | å¦        |
| `map`           | æ˜¯    | çº¢é»‘æ ‘  | å¦       | O(log n) | æ˜¯        |
| `unordered_set` | å¦    | å“ˆå¸Œè¡¨  | å¦       | å¹³å‡ O(1)  | å¦        |
| `set`           | æ˜¯    | çº¢é»‘æ ‘  | å¦       | O(log n) | æ˜¯        |

---

éå¸¸å¥½ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥æŠŠå“ˆå¸Œè¡¨ä¸é›†åˆè¿™ä¸€ç« å†™å¾—å®Œæ•´ä¸”å®ç”¨ã€‚
ä¸‹é¢æ˜¯æ‰©å±•åçš„ Markdown ç¬”è®°ï¼Œä» **6.6** å¼€å§‹è¡¥å…… **`multimap` / `multiset`**ï¼Œå†å•ç‹¬å†™ä¸€èŠ‚ **6.7 è¿­ä»£å™¨ä¸è®¿é—®è¯­æ³•è¯¦è§£ï¼ˆå« `iter->second` è¯´æ˜ï¼‰**ã€‚
æ ¼å¼ä¸ä½ ä¹‹å‰ä¿æŒä¸€è‡´ã€‚

---

### 6.6 `multimap` ä¸ `multiset` â€”â€” å…è®¸é‡å¤é”®çš„å…³è”å®¹å™¨

#### 6.6.1 `multimap<Key, Value>`

åº•å±‚ä¸ºçº¢é»‘æ ‘ç»“æ„ï¼Œ**å…è®¸ç›¸åŒ key å‡ºç°å¤šæ¬¡**ã€‚

#### å®šä¹‰

```cpp
multimap<int, string> mp;
```

#### æ’å…¥å…ƒç´ 

```cpp
mp.insert({1, "apple"});
mp.insert({2, "banana"});
mp.insert({1, "orange"});     // é”®1é‡å¤ï¼Œå…è®¸
```

#### éå†

```cpp
for (auto &p : mp)
    cout << p.first << " -> " << p.second << endl;
```

è¾“å‡ºç»“æœï¼ˆæŒ‰ key å‡åºï¼‰ï¼š

```
1 -> apple
1 -> orange
2 -> banana
```

#### æŸ¥æ‰¾æ‰€æœ‰ç›¸åŒé”®çš„å…ƒç´ 

```cpp
auto range = mp.equal_range(1);   // è¿”å›pair<iterator, iterator>
for (auto it = range.first; it != range.second; ++it)
    cout << it->second << " ";
```

#### ç‰¹ç‚¹

* æœ‰åºï¼›
* å…è®¸é‡å¤é”®ï¼›
* æ— æ³•ä½¿ç”¨ `operator[]`ï¼ˆå³ `mp[1]` å½¢å¼ä¸æ”¯æŒï¼‰ã€‚

---

#### 6.6.2 `multiset<Type>`

åº•å±‚ä¸ºçº¢é»‘æ ‘ç»“æ„ï¼Œ**å…è®¸ç›¸åŒå…ƒç´ å¤šæ¬¡æ’å…¥**ã€‚

#### å®šä¹‰ä¸æ’å…¥

```cpp
multiset<int> s;
s.insert(3);
s.insert(1);
s.insert(3);    // é‡å¤æ’å…¥åˆæ³•
```

#### éå†

```cpp
for (auto &x : s)
    cout << x << " ";          // è¾“å‡ºï¼š1 3 3
```

#### æŸ¥æ‰¾ä¸åˆ é™¤

```cpp
cout << s.count(3);            // è¾“å‡º3çš„å‡ºç°æ¬¡æ•°
s.erase(s.find(3));            // åˆ é™¤ä¸€ä¸ª3
```

#### ç‰¹ç‚¹

* å…ƒç´ è‡ªåŠ¨æœ‰åºï¼›
* å…è®¸é‡å¤å€¼ï¼›
* åˆ é™¤è¦å°å¿ƒï¼Œ`erase(3)` ä¼šåˆ é™¤æ‰€æœ‰å€¼ä¸º3çš„å…ƒç´ ï¼›
  å¦‚åªåˆ ä¸€ä¸ªï¼Œç”¨ `erase(find(3))`ã€‚

---

### 6.7 è¿­ä»£å™¨ä¸è®¿é—®è¯­æ³•è¯¦è§£ï¼ˆå« `iter->second`ï¼‰

åœ¨ C++ çš„å…³è”å®¹å™¨ä¸­ï¼ˆåŒ…æ‹¬ mapã€unordered_mapã€multimap ç­‰ï¼‰ï¼Œè¿­ä»£å™¨æ˜¯è®¿é—®å®¹å™¨å…ƒç´ çš„å…³é”®å·¥å…·ã€‚

#### 6.7.1 è¿­ä»£å™¨ç±»å‹

* å¯¹äº `map` / `unordered_map`ï¼š
  è¿­ä»£å™¨æŒ‡å‘ **é”®å€¼å¯¹ï¼ˆpair<const Key, Value>ï¼‰**ã€‚

* å¯¹äº `set` / `unordered_set`ï¼š
  è¿­ä»£å™¨æŒ‡å‘å•ä¸€çš„ **å…ƒç´ å€¼ï¼ˆKeyï¼‰**ã€‚

---

#### 6.7.2 åŸºæœ¬éå†è¯­æ³•

#### map / unordered_map

```cpp
unordered_map<int, int> mp = {{1, 10}, {2, 20}, {3, 30}};

for (auto it = mp.begin(); it != mp.end(); ++it) {
    cout << it->first << " " << it->second << endl;
}
```

#### ç­‰ä»·å†™æ³•ï¼ˆç»“æ„åŒ–ç»‘å®š C++17ï¼‰

```cpp
for (auto &[key, value] : mp)
    cout << key << " " << value << endl;
```

---

#### 6.7.3 `it->first` ä¸ `it->second` çš„å«ä¹‰

* `it->first`ï¼šè®¿é—®é”®ï¼ˆKeyï¼‰ï¼›
* `it->second`ï¼šè®¿é—®å€¼ï¼ˆValueï¼‰ã€‚

è§£é‡Šï¼š
`it` æ˜¯æŒ‡å‘ `pair<const Key, Value>` çš„æŒ‡é’ˆï¼Œæ‰€ä»¥
`it->first` ç­‰ä»·äº `(*it).first`ã€‚

ç¤ºä¾‹ï¼š

```cpp
unordered_map<int, string> name;
name[3] = "Alice";
name[5] = "Bob";

auto it = name.find(3);
if (it != name.end()) {
    cout << it->first;   // è¾“å‡º 3
    cout << it->second;  // è¾“å‡º "Alice"
}
```

---

#### 6.7.4 å¯¹ `set` / `unordered_set` çš„è¿­ä»£å™¨è®¿é—®

`set` çš„è¿­ä»£å™¨æŒ‡å‘å…ƒç´ æœ¬èº«ï¼Œæ²¡æœ‰ `.first` æˆ– `.second`ï¼š

```cpp
set<int> s = {1, 2, 3};
for (auto it = s.begin(); it != s.end(); ++it)
    cout << *it << " ";
```

---

#### 6.7.5 å¸¸è§ç”¨æ³•ç¤ºä¾‹æ•´åˆ

#### æŸ¥æ‰¾é”®æ˜¯å¦å­˜åœ¨å¹¶è®¿é—®å€¼

```cpp
unordered_map<int, int> mp;
mp[1] = 100;
mp[2] = 200;

auto it = mp.find(1);
if (it != mp.end())
    cout << it->second;    // è¾“å‡º100
else
    cout << "æœªæ‰¾åˆ°";
```

#### ä¿®æ”¹å€¼

```cpp
mp[1] = 999;           // ç›´æ¥ä¿®æ”¹
it = mp.find(2);
if (it != mp.end())
    it->second += 10;   // ä½¿ç”¨è¿­ä»£å™¨ä¿®æ”¹
```

---

#### 6.7.6 æ€»ç»“è¦ç‚¹

| ç”¨æ³•                  | è¯´æ˜                         |
| ------------------- | -------------------------- |
| `it->first`         | é”®ï¼ˆKeyï¼‰                     |
| `it->second`        | å€¼ï¼ˆValueï¼‰                   |
| `*it`               | å¯¹äº set æ˜¯å…ƒç´ å€¼ï¼›å¯¹äº map æ˜¯ pair  |
| `auto &[k, v] : mp` | C++17ç»“æ„åŒ–ç»‘å®šï¼Œç›´æ¥å±•å¼€é”®å’Œå€¼         |
| `mp.find(key)`      | è¿”å›è¿­ä»£å™¨ï¼ˆæ‰¾åˆ°ï¼‰æˆ– `mp.end()`ï¼ˆæœªæ‰¾åˆ°ï¼‰ |
| `mp.count(key)`     | åˆ¤æ–­æ˜¯å¦å­˜åœ¨ï¼ˆè¿”å›0æˆ–1ï¼‰              |

---
## 7.KMP ç®—æ³•è¯¦è§£ä¸å®ç°
### 7.1 KMP ç®—æ³•ç®€ä»‹
KMPï¼ˆKnuth-Morris-Prattï¼‰ç®—æ³•æ˜¯ä¸€ç§é«˜æ•ˆçš„å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•ï¼Œæ—¨åœ¨è§£å†³åœ¨ä¸»ä¸²ä¸­æŸ¥æ‰¾æ¨¡å¼ä¸²çš„é—®é¢˜ã€‚ç›¸æ¯”äºæœ´ç´ çš„å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•ï¼ŒKMP é€šè¿‡é¢„å¤„ç†æ¨¡å¼ä¸²ï¼Œé¿å…äº†åœ¨åŒ¹é…å¤±è´¥æ—¶å›æº¯ä¸»ä¸²ï¼Œä»è€Œæé«˜äº†åŒ¹é…æ•ˆç‡ã€‚KMP ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n + m)ï¼Œå…¶ä¸­ n æ˜¯ä¸»ä¸²é•¿åº¦ï¼Œm æ˜¯æ¨¡å¼ä¸²é•¿åº¦ã€‚
### 7.2 KMP ç®—æ³•åŸç†
KMP ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯åˆ©ç”¨æ¨¡å¼ä¸²æœ¬èº«çš„ä¿¡æ¯ï¼Œæ„å»ºä¸€ä¸ªâ€œéƒ¨åˆ†åŒ¹é…è¡¨â€ï¼ˆä¹Ÿç§°ä¸ºâ€œå¤±é…å‡½æ•°â€ï¼‰ï¼Œç”¨äºæŒ‡å¯¼åŒ¹é…è¿‡ç¨‹ä¸­çš„è·³è½¬ã€‚éƒ¨åˆ†åŒ¹é…è¡¨è®°å½•äº†æ¨¡å¼ä¸²ä¸­æ¯ä¸ªä½ç½®å‰ç¼€å’Œåç¼€çš„æœ€é•¿å…¬å…±å…ƒç´ é•¿åº¦ï¼Œä»è€Œåœ¨åŒ¹é…å¤±è´¥æ—¶ï¼Œå¯ä»¥æ ¹æ®éƒ¨åˆ†åŒ¹é…è¡¨è·³è¿‡ä¸€äº›ä¸å¿…è¦çš„æ¯”è¾ƒã€‚
### 7.3 éƒ¨åˆ†åŒ¹é…è¡¨çš„æ„å»º
éƒ¨åˆ†åŒ¹é…è¡¨çš„æ„å»ºæ˜¯ KMP ç®—æ³•çš„å…³é”®æ­¥éª¤ã€‚ä»¥ä¸‹æ˜¯æ„å»ºéƒ¨åˆ†åŒ¹é…è¡¨çš„ä»£ç å®ç°ï¼š
```cpp
vector<int> buildPartialMatchTable(const string &pattern) {
    int m = pattern.size();
    vector<int> lps(m, 0); // lps[i] è¡¨ç¤º pattern[0..i] çš„æœ€é•¿å‰åç¼€é•¿åº¦
    int len = 0; // å½“å‰æœ€é•¿å‰åç¼€é•¿åº¦
    int i = 1;

    while (i < m) {
        if (pattern[i] == pattern[len]) {
            len++;
            lps[i] = len;
            i++;
        } else {
            if (len != 0) {
                len = lps[len - 1]; // å›æº¯åˆ°ä¸Šä¸€ä¸ªæœ€é•¿å‰åç¼€é•¿åº¦
            } else {
                lps[i] = 0;
                i++;
            }
        }
    }
    return lps;
}
```
---
### 7.4 KMP åŒ¹é…è¿‡ç¨‹
KMP åŒ¹é…è¿‡ç¨‹åˆ©ç”¨éƒ¨åˆ†åŒ¹é…è¡¨æ¥æŒ‡å¯¼åŒ¹é…è¿‡ç¨‹ã€‚ä»¥ä¸‹æ˜¯
KMP åŒ¹é…çš„ä»£ç å®ç°ï¼š
```cpp
vector<int> KMPSearch(const string &text, const string &pattern) {
    vector<int> lps = buildPartialMatchTable(pattern);
    vector<int> result; // å­˜å‚¨åŒ¹é…ç»“æœçš„èµ·å§‹ç´¢å¼•
    int n = text.size();
    int m = pattern.size();
    int i = 0; // ä¸»ä¸²ç´¢å¼•
    int j = 0; // æ¨¡å¼ä¸²ç´¢å¼•

    while (i < n) {
        if (pattern[j] == text[i]) {
            i++;
            j++;
        }

        if (j == m) {
            result.push_back(i - j); // æ‰¾åˆ°åŒ¹é…ï¼Œè®°å½•èµ·å§‹ç´¢å¼•
            j = lps[j - 1]; // æ ¹æ®éƒ¨åˆ†åŒ¹é…è¡¨è·³è½¬
        } else if (i < n && pattern[j] != text[i]) {
            if (j != 0) {
                j = lps[j - 1]; // æ ¹æ®éƒ¨åˆ†åŒ¹é…è¡¨è·³è½¬
            } else {
                i++;
            }
        }
    }
    return result;
}
```
---
### 7.5 ç¤ºä¾‹ä¸æµ‹è¯•
ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨ KMP ç®—æ³•è¿›è¡Œå­—ç¬¦ä¸²åŒ¹é…çš„ç¤ºä¾‹ï¼š
```cpp
int main() {
    string text = "ababcabcabababd";
    string pattern = "ababd";
    vector<int> matches = KMPSearch(text, pattern);

    cout << "Pattern found at indices: ";
    for (int index : matches) {
        cout << index << " ";
    }
    cout << endl;
    return 0;
}
```
### 7.6 æ€»ç»“
KMP ç®—æ³•é€šè¿‡é¢„å¤„ç†æ¨¡å¼ä¸²ï¼Œæ„å»ºéƒ¨åˆ†åŒ¹é…è¡¨ï¼Œå®ç°äº†é«˜æ•ˆçš„å­—ç¬¦ä¸²åŒ¹é…ã€‚å…¶æ—¶é—´å¤æ‚åº¦ä¸º O(n + m)ï¼Œé€‚ç”¨äºéœ€è¦é¢‘ç¹è¿›è¡Œå­—ç¬¦ä¸²åŒ¹é…çš„åœºæ™¯ã€‚ç†è§£ KMP ç®—æ³•çš„åŸç†å’Œå®ç°ï¼Œæœ‰åŠ©äºæå‡ç®—æ³•è®¾è®¡å’Œé—®é¢˜è§£å†³èƒ½åŠ›ã€‚
### 7.7 KMPç­‰ä»·å°è£…å‡½æ•°
```cpp
int ans= s.find(pattern); // è¿”å›æ¨¡å¼ä¸²åœ¨ä¸»ä¸²ä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®ç´¢å¼•ï¼Œæœªæ‰¾åˆ°è¿”å›-1
//æˆ–è€…å¯ä»¥æ‰¾å‡ºæ‰€æœ‰åŒ¹é…çš„ä½ç½®ï¼š
size_t pos = text.find(pattern);
while (pos != string::npos) {
    cout << "Pattern found at index: " << pos << endl;
    pos = text.find(pattern, pos + 1); // ä»ä¸‹ä¸€ä¸ªä½ç½®ç»§ç»­æŸ¥æ‰¾
}
```
è¿™é‡ŒæŠŠæ•´ä¸ªç¬”è®°è¿›ä¸€æ­¥æ‰©å……ï¼Œè®©å†…å®¹æ›´åƒçœŸæ­£çš„ç®—æ³•ä¸“é¢˜æ–‡ç« ï¼š

1. **æ¯ä¸ªæ–¹æ³•éƒ½åŠ å…¥æ›´æ·±å…¥çš„è§£é‡Š**
2. **æ¯ä¸ªæ–¹æ³•åé™„ä¸Šç†è®ºä¾æ®**
3. **ç»“æ„ç»§ç»­ä¿æŒä» `##8` å¼€å§‹**
4. **è¯­è¨€é£æ ¼æ¸…æ™°ä¸¥è°¨ï¼ˆç”¨äºç¬”è®°ï¼Œä¸å¸¦æˆ‘å¹³æ—¶çš„èŠå¤©è¯­æ°”ï¼‰**

---

## 8. åºåˆ—å‘¨æœŸé—®é¢˜
LeetCode é¢˜ç›®é“¾æ¥ï¼š[459.é‡å¤å­å­—ç¬¦ä¸²æ¨¡å¼](https://leetcode.cn/problems/repeated-substring-pattern/)
### 8.1 æšä¸¾å­ä¸²é•¿åº¦ + å‘¨æœŸæ€§éªŒè¯
### æ€è·¯è§£æ

æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š
å¦‚æœå­—ç¬¦ä¸² `s` ç”±æŸä¸ªå­ä¸²é‡å¤ç»„æˆï¼Œé‚£ä¹ˆå­˜åœ¨ä¸€ä¸ªé•¿åº¦ `i`ï¼Œä½¿å¾— `i` æ•´é™¤ `n = s.size()`ï¼Œå¹¶ä¸”ä»ç¬¬ `i` ä¸ªå­—ç¬¦å¼€å§‹çš„æ‰€æœ‰å­—ç¬¦ï¼Œéƒ½ä¸å‰é¢ä¸€æ®µé•¿åº¦ä¸º `i` çš„å­ä¸²å¯¹åº”ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœ `s = "abcabcabc"`ï¼Œ
n = 9
å¯èƒ½çš„å­ä¸²é•¿åº¦ä¸ºï¼š1ã€3ã€‚

ä»¥ `i = 3` ä¸ºä¾‹ï¼š
æ£€æŸ¥
s[3] == s[0]
s[4] == s[1]
â€¦
è¿™ç§â€œå¯¹é½æ£€æŸ¥â€æœ¬è´¨ä¸Šå°±æ˜¯éªŒè¯å‘¨æœŸæ€§ã€‚

### ä»£ç 

```cpp
class Solution {
public:
    bool repeatedSubstringPattern(string s) {
        int n = s.size();
        if (n == 0) return false;

        for (int i = 1; i * 2 <= n; i++) {
            if (n % i == 0) {
                bool match = true;
                for (int j = i; j < n; j++) {
                    if (s[j] != s[j - i]) {
                        match = false;
                        break;
                    }
                }
                if (match) return true;
            }
        }

        return false;
    }
};
```

### æ·±åº¦è§£é‡Š

1. **ä¸ºä»€ä¹ˆåªæšä¸¾åˆ° i * 2 <= nï¼Ÿ**
   å› ä¸ºä¸€ä¸ªå‘¨æœŸæœ€çŸ­å­ä¸²è‡³å°‘è¦é‡å¤ä¸¤æ¬¡æ‰èƒ½æ„æˆåŸå­—ç¬¦ä¸²ã€‚
   è‹¥ i > n/2ï¼Œåˆ™æœ€å¤šåªèƒ½é‡å¤ä¸€æ¬¡ï¼Œä¸å¯èƒ½æˆä¸ºæœ‰æ•ˆå‘¨æœŸã€‚

2. **ä¸ºä»€ä¹ˆå¿…é¡»æ»¡è¶³ n % i == 0ï¼Ÿ**
   å­—ç¬¦ä¸²èƒ½ç”±é•¿åº¦ä¸º i çš„å­ä¸²é‡å¤ç»„æˆ â†’ å­—ç¬¦ä¸²é•¿åº¦å¿…é¡»æ˜¯ i çš„æ•´æ•°å€ã€‚

3. **æ ¸å¿ƒåŒ¹é…è¿‡ç¨‹ä¸ºä»€ä¹ˆ j ä» i å¼€å§‹ï¼Ÿ**
   å› ä¸ºç¬¬ i ä¸ªå­—ç¬¦åº”è¯¥å¯¹é½å›åˆ°ç¬¬ 0 ä¸ªå­—ç¬¦ã€‚
   å‘¨æœŸæ€§æœ¬è´¨æ˜¯ï¼š

   ```
   s[j] == s[j - i]
   ```

4. **æ—¶é—´å¤æ‚åº¦ä¸ºä»€ä¹ˆæ˜¯ O(nÂ²)?**
   Â· æœ€åæƒ…å†µï¼šä¾‹å¦‚å­—ç¬¦ä¸²å…¨æ˜¯ä¸åŒå­—ç¬¦ `"abcdefg..."`
   Â· æšä¸¾çš„ i å¤§çº¦æœ‰ n/2 ä¸ª
   Â· æ¯ä¸ªéƒ½è¦éå† n ä¸ªå­—ç¬¦
   â†’ O(nÂ²)

### ç†è®ºä¾æ®ï¼šå­—ç¬¦ä¸²å‘¨æœŸä¸å› å­

å­—ç¬¦ä¸² s çš„å‘¨æœŸæ€§å®šä¹‰ä¸ºï¼šå­˜åœ¨ä¸€ä¸ªæœ€å°æ­£æ•´æ•° kï¼Œä½¿å¾—

```
s[j] = s[j - k]
å¯¹æ‰€æœ‰ j â‰¥ k éƒ½æˆç«‹
```

å¦‚æœ k æ˜¯å‘¨æœŸï¼Œåˆ™ n å¿…é¡»æ˜¯ k çš„æ•´æ•°å€ã€‚
è¿™æ˜¯ç»å…¸å­—ç¬¦ä¸²å‘¨æœŸç†è®ºä¸­çš„**æœ€å°å‘¨æœŸï¼ˆprimitive rootï¼‰**æ¦‚å¿µã€‚
è¯¥æ–¹æ³•å°±æ˜¯ç›´æ¥åˆ©ç”¨è¿™ä¸ªç†è®ºè¿›è¡Œæšä¸¾éªŒè¯ã€‚

---

### 8.2 æ‹¼æ¥å­—ç¬¦ä¸² + æŸ¥æ‰¾ï¼ˆæ•°å­¦å‘¨æœŸæ¨è®ºï¼‰

### æ€è·¯è§£æ

è¯¥æ–¹æ³•éå¸¸å·§å¦™ï¼Œä¸éœ€è¦æ˜¾å¼åœ°æšä¸¾å‘¨æœŸã€‚
å…³é”®æ“ä½œæ˜¯:

```
s2 = s + s
åœ¨ s2 ä¸­æŸ¥æ‰¾ sï¼Œæœ¬æ¬¡æŸ¥æ‰¾ä»ä¸‹æ ‡ 1 å¼€å§‹
```

å¦‚æœ s æ˜¯ç”±æŸä¸ªå­ä¸²é‡å¤æ„æˆçš„ï¼Œé‚£ä¹ˆå®ƒä¸€å®šä¼šåœ¨ s2 çš„æŸä¸ªä¸­é—´å‡ºç°ä¸€æ¬¡ä¸é‡å çš„ä½ç½®ã€‚

ä¾‹å¦‚ï¼š
s = "abcabcabc"
s + s = "abcabcabcabcabcabc"

s ä¼šä»ç¬¬ 3 ä½é‡æ–°å¯¹é½ï¼ˆ3 = å­ä¸²é•¿åº¦ï¼‰

### ä»£ç 

```cpp
class Solution {
public:
    bool repeatedSubstringPattern(string s) {
        return (s + s).find(s, 1) != s.size();
    }
};
```

### æ·±åº¦è§£é‡Š

1. **ä¸ºä»€ä¹ˆæŸ¥æ‰¾ä» index = 1 å¼€å§‹ï¼Ÿ**
   å¦‚æœä» 0 å¼€å§‹ï¼Œä¼šç›´æ¥åŒ¹é…åˆ° (s+s) çš„æœ€å¼€å¤´é‚£ä¸ªåŸå§‹ sï¼Œå¤±å»æ„ä¹‰ã€‚
   ä» 1 å¼€å§‹æŸ¥æ‰¾ï¼Œå¯»æ‰¾â€œå†…éƒ¨çš„é‡æ–°å‡ºç°â€ã€‚

2. **ä¸ºä»€ä¹ˆå¦‚æœ `find != n` å°±è¯´æ˜å¯é‡å¤ï¼Ÿ**
   Â· è‹¥å­—ç¬¦ä¸²ç”±å­ä¸²é‡å¤ç»„æˆï¼Œåˆ™ä¼šåœ¨ s çš„å‘¨æœŸé•¿åº¦å¤„å‡ºç°ä¸€æ¬¡å¯¹é½æ„é€ ã€‚
   Â· æ­¤å‡ºç°ä¸€å®šåœ¨ `(s+s)` çš„ä¸­é—´ä½ç½®ï¼Œä¸” index < nã€‚
   Â· å¦‚æœæ‰¾ä¸åˆ°ï¼Œè¿”å› n æˆ– nposã€‚

3. **ç©ºé—´å¤æ‚åº¦ä¸ºä½•æ˜¯ O(n)**
   å› ä¸ºæ„é€ äº† s+s ä¸¤å€é•¿åº¦å­—ç¬¦ä¸²ã€‚

4. **æ—¶é—´å¤æ‚åº¦ä¸ºä½•é€šå¸¸æ˜¯ O(n)?**
   æ ‡å‡†åº“ find å®ç°é€šå¸¸ç”¨ Boyerâ€“Moore / Sunday / åŒæŒ‡é’ˆä¼˜åŒ–ç­‰æ–¹æ³•ï¼Œå› æ­¤å¹³å‡å¤æ‚åº¦æ¥è¿‘çº¿æ€§ã€‚

### ç†è®ºä¾æ®ï¼šKMP å‘¨æœŸå®šç†ï¼ˆç®€åŒ–ç‰ˆï¼‰

åœ¨å­—ç¬¦ä¸²å‘¨æœŸç†è®ºä¸­ï¼Œæœ‰è¿™æ ·ä¸€ä¸ªç»“è®ºï¼š

**è‹¥å­—ç¬¦ä¸² s ä¸æ˜¯ç”±å­ä¸²é‡å¤æ„æˆï¼Œåˆ™ s åªä¼šåœ¨ s+s ä¸­å‡ºç°ä¸¤æ¬¡ï¼šå¼€å¤´å’Œç»“å°¾ã€‚
è‹¥æ˜¯é‡å¤æ„æˆï¼Œåˆ™ä¼šåœ¨ä¸­é—´å†æ¬¡å‡ºç°ã€‚**

è¿™æ˜¯ KMP æœ€é•¿å‰åç¼€ï¼ˆLPS / Ï€ æ•°ç»„ï¼‰çš„ä¸€ä¸ªæ¨è®ºï¼š
è‹¥

```
n % (n - lps[n-1]) == 0
```

åˆ™å­—ç¬¦ä¸²å­˜åœ¨å‘¨æœŸã€‚
s+s çš„ find æ–¹æ³•æœ¬è´¨ä¸Šæ˜¯åˆ©ç”¨äº†è¿™ä¸€å‘¨æœŸç»“æ„ï¼Œåªæ˜¯æ²¡æœ‰æ˜¾å¼è®¡ç®— LPSã€‚

---

### 8.3 æ–¹æ³•æ¯”è¾ƒä¸ç†è®ºæ€»ç»“

| æ–¹æ³•      | ä¼˜åŠ¿             | åŠ£åŠ¿                   | ç†è®ºåŸºç¡€                |
| ------- | -------------- | -------------------- | ------------------- |
| æšä¸¾ + æ ¡éªŒ | æ€è·¯ç›´è§‚ï¼Œä¸ä¾èµ–åº“å‡½æ•°    | æœ€å O(nÂ²) è¾ƒæ…¢          | å­—ç¬¦ä¸²æœ€å°å‘¨æœŸçš„ç›´æ¥å®šä¹‰        |
| æ‹¼æ¥ + æŸ¥æ‰¾ | ä»£ç æå…¶ç®€æ´ï¼Œé€šå¸¸ O(n) | éœ€é¢å¤– O(n) ç©ºé—´ï¼Œä¾èµ–åº“ find | å­—ç¬¦ä¸²å‘¨æœŸåœ¨ s+s ä¸­çš„é‡æ–°å‡ºç°å®šç† |

### å‘¨æœŸç†è®ºæ€»ç»“

è‹¥ä¸€ä¸ªå­—ç¬¦ä¸² s çš„é•¿åº¦ä¸º nï¼Œè®¾å…¶æœ€é•¿å‰åç¼€é•¿åº¦ä¸º Lï¼ˆç”± KMP LPS å¾—åˆ°ï¼‰ï¼Œ
æœ€å°å‘¨æœŸä¸ºï¼š

```
period = n - L
```

å½“ä¸”ä»…å½“ï¼š

```
n % period == 0
```

å­—ç¬¦ä¸²å­˜åœ¨é‡å¤ç»“æ„ã€‚

æ–¹æ³•äºŒåˆ©ç”¨äº†è¿™ä¸ªâ€œå‘¨æœŸåœ¨åŒå€å­—ç¬¦ä¸²ä¸­å‡ºç°â€çš„æ•°å­¦æ€§è´¨ï¼Œæ˜¯ç†è®ºä¸Šæ›´ä¼˜é›…çš„åšæ³•ã€‚

---

### 8.4 æ€»ç»“

1. é‡å¤å­ä¸²æœ¬è´¨æ˜¯ **å¯»æ‰¾æœ€å°å‘¨æœŸ**ã€‚
2. æšä¸¾æ³•æ˜¯ç›´æ¥ä½¿ç”¨å‘¨æœŸçš„å®šä¹‰è¿›è¡Œæš´åŠ›éªŒè¯ã€‚
3. æ‹¼æ¥æ³•ç”¨çš„æ˜¯å­—ç¬¦ä¸²çš„**ç»“æ„æ€§è´¨**ï¼š
   è‹¥ s æœ‰å‘¨æœŸï¼Œåˆ™å®ƒåœ¨ s+s çš„ä¸­éƒ¨ä¼šå¯¹é½ã€‚
4. æ›´è¿›ä¸€æ­¥çš„ç†è®ºåŸºç¡€æ¥è‡ª KMP çš„å‰ç¼€å‡½æ•°ï¼ˆLPS æ•°ç»„ï¼‰ï¼Œå®ƒå®Œç¾æè¿°äº†å­—ç¬¦ä¸²çš„å‘¨æœŸç»“æ„ã€‚
5. åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ–¹æ³•äºŒæ›´ä¸ºé«˜æ•ˆä¸”ç®€æ´ï¼Œä½†ç†è§£æ–¹æ³•ä¸€æœ‰åŠ©äºåŠ æ·±å¯¹å­—ç¬¦ä¸²å‘¨æœŸçš„è®¤è¯†ã€‚

---
ä¸‹é¢æ˜¯æ›´æ–°åçš„ã€æ›´å®Œæ•´ã€æ›´è¯¦ç»†çš„ Markdown ç‰ˆæœ¬ã€‚
æŒ‰ç…§ä½ çš„è¦æ±‚ï¼š

1. **åœ¨è§£æ³•ä¸‰ï¼ˆå †è§£æ³•ï¼‰ä¸­åŠ å…¥ priority_queue çš„åˆå§‹åŒ–æ–¹å¼ã€å¸¸è§ä½¿ç”¨æ–¹æ³•ã€æ•°æ®ç»“æ„è¡Œä¸ºæ€»ç»“ã€‚**
2. ä¿æŒé£æ ¼ä¸¥è°¨ã€é€»è¾‘æ¸…æ™°ï¼Œä¸åŠ å…¥ emojiã€‚
3. ç»“æ„ä»å±äºä½ ç¬”è®°ä½“ç³»çš„ã€Œ## 9. åŒç«¯é˜Ÿåˆ—çš„ä½¿ç”¨/ã€ç« èŠ‚ã€‚

ä¸‹é¢å°±æ˜¯æœ€ç»ˆæ•´ç†å¥½çš„å†…å®¹ï¼Œå¯ä»¥ç›´æ¥åŠ å…¥ä½ çš„é¡¹ç›®ç¬”è®°ã€‚

---

## 9. åŒç«¯é˜Ÿåˆ—çš„ä½¿ç”¨

é¢˜ç›®é“¾æ¥ï¼š
**[æ»‘åŠ¨çª—å£æœ€å¤§å€¼ï¼ˆLeetCode 239ï¼‰](https://leetcode.cn/problems/sliding-window-maximum/)**

æ»‘åŠ¨çª—å£æœ€å¤§å€¼æ˜¯ä¸€ç±»å…¸å‹çš„â€œåŒºé—´ä¿¡æ¯ç»´æŠ¤â€é—®é¢˜ã€‚çª—å£åœ¨æ•°ç»„ä¸Šä»å·¦åˆ°å³æ»‘åŠ¨ï¼Œæ¯åˆ°ä¸€ä¸ªä½ç½®éƒ½éœ€è¦è¿”å›ä¸€æ®µé•¿åº¦ä¸º `k` çš„è¿ç»­åŒºé—´çš„æœ€å¤§å€¼ã€‚

æœ¬èŠ‚å°†ç³»ç»Ÿå¯¹æ¯”ä¸‰ç§å¸¸è§è§£æ³•ï¼š

1. ä½ çš„æ–¹æ¡ˆï¼šæœ€å¤§å€¼ + è¿‡æœŸåé‡æ‰«çª—å£
2. å®˜æ–¹æ–¹æ¡ˆä¸€ï¼šæœ€å¤§å † priority_queue + æ‡’åˆ é™¤
3. å®˜æ–¹æœ€ä¼˜æ–¹æ¡ˆï¼šåŒç«¯é˜Ÿåˆ—ï¼ˆç»´æŠ¤å•è°ƒé˜Ÿåˆ—ï¼‰

å¹¶åœ¨è§£æ³•ä¸‰ä¸­è¯¦ç»†æ‰©å±• priority_queue çš„åˆå§‹åŒ–æ–¹å¼ã€åŸºæœ¬ç”¨æ³•ã€å¸¸è§æ“ä½œæŠ€å·§ã€‚

---

### 9.1 é—®é¢˜æè¿°

ç»™å®šæ•°ç»„ `nums` å’Œæ•´æ•° `k`ï¼Œæ¯æ¬¡çª—å£å³ç§»ä¸€æ ¼ï¼Œè¿”å›çª—å£ä¸­æœ€å¤§å€¼ã€‚

ç¤ºä¾‹ï¼š

```
nums = [1,3,-1,-3,5,3,6,7], k = 3
è¾“å‡º      [3,3,5,5,6,7]
```

çª—å£å¤§å°æ’å®šï¼Œç§»åŠ¨æ–¹å¼å›ºå®šã€‚

---

### 9.2 è§£æ³•ä¸€ï¼šä½ çš„æ–¹æ³•ï¼ˆæœ€å¤§å€¼ + è¿‡æœŸåé‡æ–°æ‰«æçª—å£ï¼‰

ä½ çš„æ–¹æ³•ç»“æ„ï¼š

1. ç»´æŠ¤å½“å‰çª—å£æœ€å¤§å€¼ `maxVal` å’Œå…¶ä¸‹æ ‡ `maxIdx`ã€‚
2. æ¯æ¬¡çª—å£å³ç§»ï¼š

   * è‹¥æ–°å…ƒç´  â‰¥ `maxVal`ï¼Œç›´æ¥æ›´æ–°ã€‚
   * è‹¥æœ€å¤§å€¼è¿˜åœ¨çª—å£å†…éƒ¨ï¼Œåˆ™ç»§ç»­æ²¿ç”¨ã€‚
   * è‹¥æœ€å¤§å€¼è¿‡æœŸï¼Œåˆ™é‡æ–°æ‰«æçª—å£å†…éƒ¨å¯»æ‰¾æœ€å¤§å€¼ã€‚

è¿‡æœŸåçš„é‡æ‰«æ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š

```cpp
if (maxIdx < left) {
    maxVal = nums[left];
    for (int i = left + 1; i < right; i++) {
        maxVal = max(maxVal, nums[i]);
    }
}
```

### è¿™ç§æ–¹æ³•çš„é—®é¢˜

å½“æ•°ç»„å½¢å¦‚ï¼š

```
[100000, 1, 1, 1, ..., 1]
```

åŒæ—¶çª—å£å¾ˆå¤§ï¼Œé‚£ä¹ˆçª—å£æ¯æ¬¡å³ç§»æ—¶æœ€å¤§å€¼éƒ½ä¼šä»å·¦ä¾§æ»‘å‡ºï¼Œä½ çš„ä»£ç å°±ä¼šä¸æ–­è§¦å‘â€œé‡æ–°æ‰«æçª—å£â€çš„è¿‡ç¨‹ï¼Œæ¯æ¬¡è€—è´¹ O(k)ï¼Œæ€»å…± O(n) æ¬¡ã€‚

æ—¶é—´å¤æ‚åº¦é€€åŒ–ä¸ºï¼š

```
O(n * k)
```

å½“ k æ¥è¿‘ n æ—¶ï¼Œè¿™ä¸ªå¤æ‚åº¦ä¼šå¯¼è‡´æ˜æ˜¾çš„ TLEã€‚

---

### 9.3 è§£æ³•äºŒï¼šæœ€å¤§å † priority_queueï¼ˆå®˜æ–¹ä¸€ç§æ€è·¯ï¼‰

æœ€å¤§å †å­˜å‚¨ `(nums[i], i)`ï¼Œåˆ©ç”¨å †é¡¶è·å¾—å½“å‰æœ€å¤§å€¼ï¼Œå¹¶ä½¿ç”¨â€œæ‡’åˆ é™¤â€ç­–ç•¥å¤„ç†è¿‡æœŸå…ƒç´ ã€‚

ä»£ç å¦‚ä¸‹ï¼š

```cpp
class Solution {
public:
    vector<int> maxSlidingWindow(vector<int>& nums, int k) {
        int n = nums.size();
        priority_queue<pair<int, int>> q;

        // åˆå§‹åŒ–å‰ k ä¸ªå…ƒç´ 
        for (int i = 0; i < k; ++i) {
            q.emplace(nums[i], i);
        }

        vector<int> ans = { q.top().first };

        // æ»‘åŠ¨çª—å£
        for (int i = k; i < n; ++i) {
            q.emplace(nums[i], i);

            // ç§»é™¤è¿‡æœŸå…ƒç´ 
            while (q.top().second <= i - k) {
                q.pop();
            }

            ans.push_back(q.top().first);
        }
        return ans;
    }
};
```

---

### 9.4 priority_queue çš„ç»“æ„ä¸ç”¨æ³•ï¼ˆæ‰©å±•è¯´æ˜ï¼‰

ä¸ºäº†å®Œå…¨ç†è§£è¿™ä¸€è§£æ³•ï¼Œæœ¬èŠ‚è¡¥å…… priority_queue çš„åŸºç¡€ç»“æ„ä¸å…¸å‹ä½¿ç”¨æ¨¡å¼ã€‚

#### 9.4.1 priority_queue çš„é»˜è®¤è¡Œä¸º
C++ çš„ priority_queue é»˜è®¤æ˜¯**å¤§æ ¹å †**ï¼ˆæœ€å¤§å †ï¼‰ï¼Œå³å †é¡¶ä¸ºæœ€å¤§å€¼ã€‚

æœ€åŸºç¡€å®šä¹‰æ–¹å¼ï¼š

```cpp
priority_queue<int> pq;
```

ç­‰ä»·äºï¼š

```
pq.top() å§‹ç»ˆæ˜¯å½“å‰æœ€å¤§æ•´æ•°
```

---

#### 9.4.2 å­˜ pair çš„ priority_queue

åœ¨æœ¬é¢˜ä¸­ï¼Œéœ€è¦åŒæ—¶è®°å½•ï¼š

* æ•°å€¼å¤§å° â†’ æ’åºå…³é”®å­—ï¼ˆå †é¡¶æœ€å¤§ï¼‰
* ä¸‹æ ‡ â†’ åˆ¤æ–­æ˜¯å¦è¿‡æœŸ

æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ `pair<int,int>`ã€‚

é»˜è®¤ pair çš„æ¯”è¾ƒæ–¹å¼ä¸ºï¼š

```
å…ˆæ¯”è¾ƒ firstï¼Œå†æ¯”è¾ƒ second
```

å› æ­¤ï¼š

```cpp
priority_queue<pair<int,int>> pq;
```

å †é¡¶ä¸º first æœ€å¤§çš„ pairï¼Œå¦‚æœ first ç›¸åŒï¼Œsecond æœ€å¤§è€…ä¼˜å…ˆã€‚

---

#### 9.4.3 å¸¸ç”¨æ“ä½œæ€»ç»“

| æ“ä½œ              | å«ä¹‰        | æ—¶é—´å¤æ‚åº¦    |
| --------------- | --------- | -------- |
| `pq.emplace(x)` | æ’å…¥å…ƒç´       | O(log n) |
| `pq.top()`      | æŸ¥çœ‹å †é¡¶ï¼ˆæœ€å¤§å€¼ï¼‰ | O(1)     |
| `pq.pop()`      | åˆ é™¤å †é¡¶      | O(log n) |
| `pq.empty()`    | æ˜¯å¦ä¸ºç©º      | O(1)     |

å †ä¸æ”¯æŒåˆ é™¤ä»»æ„ä½ç½®å…ƒç´ ï¼Œä¹Ÿä¸èƒ½â€œéå†åˆ é™¤â€ã€‚
å› æ­¤åªèƒ½é€šè¿‡â€œæ‡’åˆ é™¤â€çš„æ–¹å¼å¤„ç†è¿‡æœŸå…ƒç´ ï¼š
å³å½“å †é¡¶ä¸‹æ ‡ä¸åœ¨çª—å£å†…éƒ¨æ—¶å¼¹å‡ºã€‚

---

#### 9.4.4 ä¸ºä»€ä¹ˆ priority_queue åœ¨æœ¬é¢˜å¯è¡Œï¼Ÿ

å› ä¸ºï¼š

* ä»»æ„æ—¶åˆ»å †é¡¶æ˜¯æœ€å¤§å€¼ï¼ˆå¯èƒ½è¿‡æœŸï¼‰
* é€šè¿‡ä¸æ–­å¼¹å‡ºï¼Œåªéœ€å°‘é‡ä»£ä»·è®©å †é¡¶æˆä¸ºçœŸæ­£æœ‰æ•ˆçš„æœ€å¤§å€¼

ç›¸æ¯”ä½ çš„æ–¹æ³•ï¼š

* é¿å…äº†å¯¹æ•´ä¸ªçª—å£çš„é‡æ–°æ‰«æ
* æ¯ä¸ªå…ƒç´ æœ€å¤šè¢«å¼¹å‡ºä¸€æ¬¡
* æ€»å¤æ‚åº¦å˜ä¸º `O(n log n)`ï¼Œè¶³ä»¥é€šè¿‡è¯„æµ‹

---

### 9.5 è§£æ³•ä¸‰ï¼ˆæœ€ä¼˜ï¼‰ï¼šåŒç«¯é˜Ÿåˆ—ç»´æŠ¤å•è°ƒé€’å‡é˜Ÿåˆ—ï¼ˆO(n)ï¼‰

åŒç«¯é˜Ÿåˆ—ä¿å­˜çª—å£ä¸­â€œå¯èƒ½æˆä¸ºæœ€å¤§å€¼çš„å€™é€‰è€…â€ï¼Œå¹¶æŒç»­ä¿æŒé˜Ÿåˆ—ä¸­çš„å€¼æ˜¯é€’å‡çš„ã€‚

è¡Œä¸ºè§„åˆ™ï¼š

1. åœ¨åŠ å…¥æ–°å…ƒç´ ä¹‹å‰ï¼Œå°†æ‰€æœ‰æ¯”å®ƒå°çš„å…ƒç´ ä»é˜Ÿå°¾å¼¹å‡ºï¼›
   è¿™äº›å…ƒç´ æ°¸è¿œä¸ä¼šæˆä¸ºæœ€å¤§å€¼ã€‚
2. å½“é˜Ÿé¦–å…ƒç´ çš„ä½ç½®å°äºçª—å£å·¦è¾¹ç•Œæ—¶ï¼Œä»é˜Ÿé¦–å¼¹å‡ºã€‚
3. é˜Ÿé¦–å§‹ç»ˆæ˜¯å½“å‰çª—å£æœ€å¤§å€¼ã€‚

ä»£ç å¦‚ä¸‹ï¼š

```cpp
class Solution {
public:
    vector<int> maxSlidingWindow(vector<int>& nums, int k) {
        deque<int> dq; // å­˜ä¸‹æ ‡ï¼Œå€¼å¯¹åº”é€’å‡
        vector<int> ans;

        for (int i = 0; i < nums.size(); i++) {

            // ç§»é™¤çª—å£å¤–å…ƒç´ 
            if (!dq.empty() && dq.front() <= i - k)
                dq.pop_front();

            // ä¿æŒå•è°ƒé€’å‡
            while (!dq.empty() && nums[dq.back()] <= nums[i])
                dq.pop_back();

            dq.push_back(i);

            if (i >= k - 1)
                ans.push_back(nums[dq.front()]);
        }
        return ans;
    }
};
```

### ä¸ºä»€ä¹ˆè¿™æ˜¯æœ€ä¼˜è§£ï¼Ÿ

* æ¯ä¸ªå…ƒç´ åªä¼šå…¥é˜Ÿä¸€æ¬¡ã€å‡ºé˜Ÿä¸€æ¬¡
* å•æ¬¡æ“ä½œ amortizedï¼ˆå‡æ‘Šï¼‰ä¸º O(1)
* æ€»å¤æ‚åº¦ O(n)

æ— è®ºè¾“å…¥æ•°æ®å¦‚ä½•ï¼Œéƒ½ä¸ä¼šé€€åŒ–æˆ–è§¦å‘å¤§é‡é‡å¤è®¡ç®—ã€‚

---

### 9.6 ä¸‰ç§è§£æ³•ç³»ç»Ÿå¯¹æ¯”ï¼ˆæœ€ç»ˆæ€»ç»“ï¼‰

| æ–¹æ³•                 | æœºåˆ¶         | æ˜¯å¦ä¼šé‡å¤æ‰«æ         | æ—¶é—´å¤æ‚åº¦      | è¯„æµ‹ç¨³å®šæ€§  |
| ------------------ | ---------- | --------------- | ---------- | ------ |
| **ä½ çš„æ–¹æ³•**           | æœ€å¤§å€¼ + è¿‡æœŸé‡æ‰« | å¯èƒ½é¢‘ç¹é‡æ‰«çª—å£        | O(n*k)     | å®¹æ˜“ TLE |
| **priority_queue** | æœ€å¤§å † + æ‡’åˆ é™¤  | å…ƒç´ æœ€å¤š log(n) æ¬¡æ“ä½œ | O(n log n) | ç¨³å®š     |
| **deque å•è°ƒé˜Ÿåˆ—**     | é€’å‡é˜Ÿåˆ—       | ä¸é‡å¤æ‰«æï¼Œå•æ¬¡è¿›å‡ºé˜Ÿ     | O(n)       | æœ€ç¨³å®šã€æœ€ä¼˜ |

---

### 9.7 æ€»ç»“

æ»‘åŠ¨çª—å£æœ€å¤§å€¼å±•ç¤ºäº†ä¸åŒæ•°æ®ç»“æ„å¤„ç†åŒºé—´é—®é¢˜çš„èƒ½åŠ›å·®å¼‚ï¼š

* æœ´ç´ æ–¹æ¡ˆå› ä¸ºçª—å£æ‰«ææˆæœ¬é«˜ï¼Œåœ¨æœ€åæƒ…å†µä¸‹ä¼šæ˜æ˜¾é€€åŒ–ã€‚
* å †ç»“æ„é€šè¿‡æŒ‰éœ€å¼¹å‡ºæ— æ•ˆå…ƒç´ ï¼Œé¿å…äº†é‡å¤éå†ï¼Œä½†ä»å­˜åœ¨ log(n) çš„å¤æ‚åº¦ç“¶é¢ˆã€‚
* åŒç«¯é˜Ÿåˆ—åˆ©ç”¨â€œå•è°ƒæ€§â€åªç»´æŠ¤çœŸæ­£æœ‰æ„ä¹‰çš„å€™é€‰è€…ï¼Œå®ç°äº†çº¿æ€§æ—¶é—´ã€‚

æœ¬é¢˜è¢«æ™®éè§†ä¸ºå­¦ä¹ â€œå•è°ƒé˜Ÿåˆ—â€çš„æœ€ä½³åˆ‡å…¥ç‚¹ï¼Œä¹Ÿæ˜¯æ•°æ®ç»“æ„ä¼˜åŒ–çš„é‡è¦æ¡ˆä¾‹ã€‚

## 10. å †ï¼ˆpriority_queueï¼‰ä¸ TopK é«˜é¢‘å…ƒç´ 

å †ï¼ˆHeapï¼‰æ˜¯å®ç°â€œä¼˜å…ˆè®¿é—®æœ€å¤§å€¼æˆ–æœ€å°å€¼â€æœ€å¸¸è§çš„æ•°æ®ç»“æ„ã€‚
åœ¨ C++ ä¸­å †å¯¹åº” priority_queueï¼Œé»˜è®¤æ˜¯ å¤§æ ¹å †ï¼ˆæœ€å¤§å€¼ä¼˜å…ˆï¼‰ã€‚
è€Œ TopK é«˜é¢‘å…ƒç´ è¿™ä¸ªç»å…¸é¢˜ï¼Œåˆšå¥½ä½“ç°äº† å¤§æ ¹å † vs å°æ ¹å † çš„å·®åˆ«ã€‚

### 10.1 é¢˜ç›®ï¼šå‰ K ä¸ªé«˜é¢‘å…ƒç´ 

LeetCode 347: [347. Top K Frequent Elements](https://leetcode.cn/problems/top-k-frequent-elements/)é¢˜ç›®è¦æ±‚ä»æ•°ç»„ä¸­æ‰¾å‡ºå‡ºç°æ¬¡æ•°æœ€å¤šçš„ k ä¸ªå…ƒç´ ã€‚å¹¶ä¸”æ—¶é—´å¤æ‚åº¦å¿…é¡»ä¼˜äº O(n log n)ã€‚

### 10.2 æˆ‘è‡ªå·±çš„ä»£ç ï¼ˆå¤§æ ¹å †å®ç°ï¼‰

ä¸‹é¢æ˜¯æˆ‘è‡ªå·±å†™çš„ç‰ˆæœ¬ã€‚
æµç¨‹ç®€å•ç›´æ¥ï¼š

ç”¨ unordered_map ç»Ÿè®¡é¢‘ç‡

ç”¨å¤§æ ¹å †æŠŠæ‰€æœ‰å…ƒç´ éƒ½ä¸¢è¿›å»

Pop k æ¬¡å¾—åˆ°ç»“æœ
```cpp
class Solution {
public:
    vector<int> topKFrequent(vector<int>& nums, int k) {
        unordered_map<int,int> freq;
        for(int x : nums) freq[x]++;

        priority_queue<pair<int,int>> pq;
        for(auto &p : freq) {
            pq.emplace(p.second, p.first);   // (é¢‘ç‡, å€¼)
        }

        vector<int> ans;
        for(int i=0; i<k; i++){
            ans.push_back(pq.top().second);
            pq.pop();
        }
        return ans;
    }
};
```

âœ” ä¼˜ç‚¹

ç›´è§‚ã€å®¹æ˜“å†™

æ€è·¯æ¸…æ™°

âœ˜ ç¼ºç‚¹

å †çš„å¤§å° = mï¼ˆä¸åŒæ•°å­—ç§ç±»æ•°ï¼‰

æ—¶é—´å¤æ‚åº¦ = O(m log m)

ç©ºé—´å¼€é”€å¤§

æ²¡æœ‰åˆ©ç”¨â€œåªéœ€è¦å‰ k ä¸ªâ€çš„ä¼˜åŠ¿

### 10.3 å®˜æ–¹é¢˜è§£ï¼ˆå°æ ¹å † TopK æ–¹æ³•ï¼‰

å®˜æ–¹æ–¹æ³•æ›´ä¼˜ã€‚
å †ä¸­æœ€å¤šåªæ”¾ k ä¸ªå…ƒç´ ï¼Œå¤šäº†å°±è¸¢æ‰æœ€å°çš„ã€‚

æ ¸å¿ƒæ€æƒ³ï¼š

ç”¨â€œå°æ ¹å †â€ï¼Œè®©å †é¡¶æ°¸è¿œæ˜¯å½“å‰ top-k ä¸­æœ€å°çš„é¢‘ç‡ã€‚
è‹¥æ–°å…ƒç´ æ¯”å †é¡¶å¤§ï¼Œå°±æ›¿æ¢ã€‚

ä»£ç å¦‚ä¸‹ï¼š
```cpp
class Solution {
public:
    static bool cmp(pair<int, int>& a, pair<int, int>& b) {
        return a.second > b.second; // å°æ ¹å †ï¼šé¢‘ç‡å°çš„ä¼˜å…ˆ
    }

    vector<int> topKFrequent(vector<int>& nums, int k) {
        unordered_map<int, int> freq;
        for (int x : nums) freq[x]++;

        priority_queue<
            pair<int,int>,
            vector<pair<int,int>>,
            decltype(&cmp)
        > pq(cmp);

        for (auto& [num, count] : freq) {
            if (pq.size() == k) {
                if (pq.top().second < count) {
                    pq.pop();
                    pq.emplace(num, count);
                }
            } else {
                pq.emplace(num, count);
            }
        }

        vector<int> res;
        while (!pq.empty()) {
            res.push_back(pq.top().first);
            pq.pop();
        }
        return res;
    }
};
```
### 10.4 ä¸¤ç§æ–¹æ³•å¯¹æ¯”æ€»ç»“
é¡¹ç›®	æˆ‘çš„å®ç°ï¼ˆå¤§æ ¹å †ï¼‰	å®˜æ–¹å®ç°ï¼ˆå°æ ¹å †ï¼‰
å †å¤§å°	mï¼ˆç§ç±»æ•°ï¼‰	kï¼ˆå›ºå®šï¼‰
æ—¶é—´å¤æ‚åº¦	O(m log m)	O(m log k)
ç©ºé—´å¤æ‚åº¦	O(m)	O(k)
æ€è·¯	å…¨æ’åº	ç»´æŠ¤å‰ K å¤§
æ˜“å†™æ€§	ç®€å•	ç¨å¤æ‚
æ€§èƒ½	ä¸€èˆ¬	å¼ºï¼ˆk â‰ª m æ—¶éå¸¸æ˜æ˜¾ï¼‰
### 10.5 priority_queue å°æ ¹å †çš„è¯­æ³•æ€»ç»“ï¼ˆæœ€é‡è¦ï¼‰

C++ é»˜è®¤æ˜¯å¤§æ ¹å †ï¼Œå¦‚æœä½ æƒ³å˜æˆå°æ ¹å †ï¼Œéœ€è¦æŒ‡å®š Compareã€‚

ä¸‹é¢æˆ‘æ€»ç»“ å››ç§å†™æ³•ï¼Œä»»é€‰ä¸€ç§å³å¯ã€‚

#### 10.5.1 æ–¹å¼ä¸€ï¼ˆæœ€ä½³ï¼‰ï¼šç”¨ lambda
```cpp
auto cmp = [](const pair<int,int>& a, const pair<int,int>& b) {
    return a.second > b.second;  // å°æ ¹å †
};

priority_queue<
    pair<int,int>,
    vector<pair<int,int>>,
    decltype(cmp)
> pq(cmp);
```

ç®€æ´ã€ç°ä»£ã€æ¨èã€‚

#### 10.5.2 æ–¹å¼äºŒï¼šç”¨ structï¼ˆä¼ ç»Ÿç¨³å®šï¼‰
```cpp
struct Cmp {
    bool operator()(const pair<int,int>& a, const pair<int,int>& b) const {
        return a.second > b.second;
    }
};
priority_queue<pair<int,int>, vector<pair<int,int>>, Cmp> pq;
```
å®¹æ˜“ç†è§£ï¼Œä¸ç”¨ decltypeã€‚

#### 10.5.3 æ–¹å¼ä¸‰ï¼ˆè¶…ç®€æ´ï¼‰ï¼šç”¨ greater

å‰æï¼šä½ æŠŠâ€œé¢‘ç‡â€æ”¾åœ¨ pair å‰é¢ï¼š

```cpp
priority_queue<
    pair<int,int>,
    vector<pair<int,int>>,
    greater<pair<int,int>>
> pq;
```

ç„¶åï¼š
```cpp
pq.emplace(count, num);
```

è¿™æ˜¯å†™ TopK æœ€å¸¸ç”¨çš„æŠ€å·§ï¼

#### 10.5.4 æ–¹å¼å››ï¼šç”¨å‡½æ•°æŒ‡é’ˆï¼ˆå®˜æ–¹å†™æ³•ï¼‰
```cpp
priority_queue<pair<int,int>, vector<pair<int,int>>, decltype(&cmp)> pq(cmp);
```

æ¯”è¾ƒéš¾è®°ï¼Œä¸æ¨èï¼Œä½†æ˜¯é¢˜è§£é‡Œç”¨äº†ã€‚

### 10.6 ä»€ä¹ˆæ—¶å€™åº”è¯¥ç”¨â€œå¤§å°ä¸º k çš„å°æ ¹å †â€ï¼Ÿ

åªè¦ä½ çš„ä»»åŠ¡æ˜¯ï¼š

æ‰¾å‰ k å¤§é¢‘ç‡

æ‰¾å‰ k å¤§å€¼

æ‰¾å‰ k å°å€¼çš„åé¢ç‰ˆæœ¬

å®æ—¶ç»´æŠ¤ä¸€ç»„æ•°æ®çš„å‰ k å

æµå¼ topKï¼ˆæ•°æ®ä¸æ–­è¿›æ¥ï¼‰

é«˜é¢‘å•è¯ï¼ˆword frequencyï¼‰

ç”µå½±è¯„åˆ† top10

è¿™ç§é—®é¢˜éƒ½é€‚åˆâ€œå›ºå®š k çš„å°æ ¹å †â€ã€‚

### 10.7 é€šç”¨ TopK æ¨¡æ¿ï¼ˆå¯ç›´æ¥å¤ç”¨ï¼‰

ä¸‹é¢æ˜¯æœ€æ¨èçš„å†™æ³•ï¼ˆä½¿ç”¨ greaterï¼‰ï¼š
```cpp
vector<int> topKFrequent(vector<int>& nums, int k) {
    unordered_map<int,int> freq;
    for (int x : nums) freq[x]++;

    priority_queue<
        pair<int,int>,
        vector<pair<int,int>>,
        greater<pair<int,int>>
    > pq; // å°æ ¹å †ï¼š(é¢‘ç‡, å€¼)

    for (auto &p : freq) {
        pq.emplace(p.second, p.first);
        if (pq.size() > k) pq.pop(); // ç»´æŠ¤å †å¤§å° <= k
    }

    vector<int> res;
    while (!pq.empty()) {
        res.push_back(pq.top().second);
        pq.pop();
    }
    return res;
}
```
ä¼˜é›…ã€ç®€æ´ã€æ€§èƒ½æœ€é«˜ã€‚
## 11. äºŒå‰æ ‘è§†å›¾é—®é¢˜ï¼ˆView Problemsï¼‰
[äºŒå‰æ ‘çš„å³è§†å›¾](https://leetcode.cn/problems/binary-tree-right-side-view/description/ )
æœ¬ç« è®¨è®ºä»æŸä¸ªâ€œè§†è§’â€è§‚å¯ŸäºŒå‰æ ‘æ—¶èƒ½çœ‹åˆ°çš„èŠ‚ç‚¹åºåˆ—ã€‚  
å…¸å‹é—®é¢˜åŒ…æ‹¬ï¼š

- äºŒå‰æ ‘å³è§†å›¾ï¼ˆRight Side Viewï¼‰
- äºŒå‰æ ‘å·¦è§†å›¾ï¼ˆLeft Side Viewï¼‰
- å…¶ä»–æ‹“å±•è§†å›¾ï¼ˆä¸Šè§†å›¾ / ä¸‹è§†å›¾ç­‰ï¼‰

æœ¬èŠ‚åªæ•´ç† **å³è§†å›¾ï¼ˆRight Side Viewï¼‰**ï¼Œä½œä¸ºè§†å›¾ç±»é—®é¢˜çš„åŸºç¡€æ¨¡æ¿ã€‚

---

### 11.1 äºŒå‰æ ‘å³è§†å›¾ï¼ˆRight Side Viewï¼‰

#### 11.1.1 é¢˜ç›®æè¿°

ç»™å®šä¸€æ£µäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ `root`ï¼Œè¿”å›ä»**å³ä¾§**è§‚å¯Ÿè¿™æ£µæ ‘æ—¶ï¼Œæ¯ä¸€å±‚èƒ½çœ‹åˆ°çš„èŠ‚ç‚¹å€¼ï¼ˆä»ä¸Šåˆ°ä¸‹çš„é¡ºåºï¼‰ã€‚

ç¤ºæ„ä¾‹å­ï¼š

```text
    1
   / \
  2   3
   \   \
    5   4
```
ä»å³ä¾§çœ‹ï¼Œæ¯ä¸€å±‚èƒ½çœ‹åˆ°çš„èŠ‚ç‚¹ä¸ºï¼š
	â€¢	ç¬¬ 0 å±‚ï¼š1
	â€¢	ç¬¬ 1 å±‚ï¼š3
	â€¢	ç¬¬ 2 å±‚ï¼š4

è¾“å‡ºç»“æœï¼š

[1, 3, 4]


#### 11.1.2 æ€è·¯æ€»è§ˆ
æœ¬è´¨ï¼šå³è§†å›¾ = æ¯ä¸€å±‚çš„æœ€å³èŠ‚ç‚¹ã€‚

å› æ­¤é—®é¢˜å¯ä»¥è½¬åŒ–ä¸ºï¼š

è®¾è®¡ä¸€ç§éå†æ–¹å¼ï¼Œåœ¨éå†è¿‡ç¨‹ä¸­ï¼Œèƒ½å¤Ÿåœ¨æ¯ä¸ªæ·±åº¦ï¼ˆå±‚æ•°ï¼‰ä¸Šé€‰å‡ºâ€œæœ€å³â€çš„é‚£ä¸ªèŠ‚ç‚¹ã€‚

å¸¸ç”¨ä¸¤ç§è§£æ³•ï¼š
	1.	DFSï¼ˆæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œå³å­æ ‘ä¼˜å…ˆï¼‰
	â€¢	éå†é¡ºåºï¼šå³å­æ ‘ â†’ å·¦å­æ ‘
	â€¢	æ¯å±‚ç¬¬ä¸€æ¬¡è®¿é—®åˆ°çš„èŠ‚ç‚¹å°±æ˜¯æœ€å³èŠ‚ç‚¹
	2.	BFSï¼ˆå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼Œå±‚åºéå†ï¼‰
	â€¢	æ¯å±‚ä»å·¦åˆ°å³è®¿é—®
	â€¢	æ¯å±‚æœ€åä¸€ä¸ªè®¿é—®çš„èŠ‚ç‚¹å°±æ˜¯æœ€å³èŠ‚ç‚¹

ä¸¤ç§æ–¹æ³•éƒ½éå†æ•´æ£µæ ‘ï¼Œä½†åªè®°å½•å¯¹ç­”æ¡ˆæœ‰è´¡çŒ®çš„èŠ‚ç‚¹ï¼ˆæ¯å±‚ 1 ä¸ªï¼‰ï¼Œå±äºâ€œéå†ä¸­çš„å…³é”®ä¿¡æ¯æå–â€ã€‚

#### 11.1.3 è§£æ³•ä¸€ï¼šDFSï¼ˆå³å­æ ‘ä¼˜å…ˆï¼‰
æ ¸å¿ƒæ€æƒ³ï¼š
	â€¢	æ”¹å˜ DFS çš„è®¿é—®é¡ºåºï¼šå…ˆè®¿é—®å³å­æ ‘ï¼Œå†è®¿é—®å·¦å­æ ‘ã€‚
	â€¢	å¯¹äºæ¯ä¸€å±‚ï¼Œç¬¬ä¸€æ¬¡è®¿é—®åˆ°çš„èŠ‚ç‚¹å¿…ç„¶æ˜¯è¿™å±‚æœ€å³ä¾§çš„èŠ‚ç‚¹ã€‚
	â€¢	ç”¨ depth == ans.size() åˆ¤æ–­â€œæ˜¯å¦æ˜¯è¯¥å±‚ç¬¬ä¸€æ¬¡è®¿é—®â€ï¼Œè‹¥æ˜¯ï¼Œåˆ™å°†å½“å‰èŠ‚ç‚¹å€¼åŠ å…¥ç­”æ¡ˆæ•°ç»„ã€‚

é€’å½’æœç´¢é¡ºåºï¼š

æ ¹èŠ‚ç‚¹ï¼ˆdepth = 0ï¼‰
  â”œâ”€ å…ˆé€’å½’å³å­æ ‘ï¼ˆdepth + 1ï¼‰
  â””â”€ å†é€’å½’å·¦å­æ ‘ï¼ˆdepth + 1ï¼‰

è¿™æ ·åœ¨æŸä¸€ä¸ª depth ä¸Šï¼Œç¬¬ä¸€ä¸ªè¢«è®¿é—®åˆ°çš„èŠ‚ç‚¹ï¼Œå¿…ç„¶æ¥è‡ªå½“å‰å±‚æœ€å³ä¾§è·¯å¾„ã€‚

ä»£ç å®ç°ï¼ˆC++ï¼‰
```cpp
class Solution {
public:
    vector<int> rightSideView(TreeNode* root) {
        vector<int> ans;
        dfs(root, 0, ans);
        return ans;
    }

private:
    void dfs(TreeNode* node, int depth, vector<int>& ans) {
        if (!node) return;

        // è‹¥å½“å‰æ·±åº¦é¦–æ¬¡è¢«è®¿é—®ï¼ˆdepth == ans.size()ï¼‰ï¼Œè®°å½•è¯¥èŠ‚ç‚¹
        if (depth == ans.size()) {
            ans.push_back(node->val);
        }

        // å…ˆè®¿é—®å³å­æ ‘ï¼Œå†è®¿é—®å·¦å­æ ‘
        dfs(node->right, depth + 1, ans);
        dfs(node->left, depth + 1, ans);
    }
};

```

æ­£ç¡®æ€§è¯´æ˜è¦ç‚¹
	1.	è®¿é—®é¡ºåºä¿è¯â€œæœ€å³ä¼˜å…ˆâ€
å¯¹äºæ¯ä¸€å±‚ï¼ŒDFS æ€»æ˜¯æ²¿ç€å³ä¾§è·¯å¾„ä¼˜å…ˆæ·±å…¥ï¼Œå› æ­¤åœ¨æ·±åº¦ d ç¬¬ä¸€æ¬¡è®¿é—®åˆ°çš„èŠ‚ç‚¹ä¸€å®šæ˜¯è¯¥å±‚æœ€å³ä¾§çš„èŠ‚ç‚¹ä¹‹ä¸€ã€‚
	2.	depth == ans.size() çš„å«ä¹‰
	â€¢	ans.size() å§‹ç»ˆç­‰äºå½“å‰å·²ç»è®°å½•çš„å±‚æ•°ã€‚
	â€¢	å½“ç¬¬ä¸€æ¬¡åˆ°è¾¾æŸä¸ªæ·±åº¦ depth æ—¶ï¼Œdepth == ans.size() ä¸€å®šæˆç«‹ã€‚
	â€¢	åç»­è‹¥å†åˆ°è¾¾åŒä¸€æ·±åº¦ï¼ˆä¾‹å¦‚ä»å·¦å­æ ‘æ–¹å‘ï¼‰ï¼Œæ­¤æ—¶ depth < ans.size()ï¼Œä¸ä¼šé‡å¤è®°å½•ï¼Œä¿è¯æ¯å±‚åªä¿ç•™ä¸€ä¸ªèŠ‚ç‚¹ã€‚


å¤æ‚åº¦åˆ†æ
	â€¢	æ—¶é—´å¤æ‚åº¦ï¼š O(n)
æ¯ä¸ªèŠ‚ç‚¹è¢«é€’å½’è®¿é—®ä¸€æ¬¡ã€‚
	â€¢	ç©ºé—´å¤æ‚åº¦ï¼š O(h)
å…¶ä¸­ h ä¸ºæ ‘çš„é«˜åº¦ï¼Œé€’å½’è°ƒç”¨æ ˆçš„æœ€å¤§æ·±åº¦ã€‚
	â€¢	æœ€å¥½æƒ…å†µï¼ˆå¹³è¡¡æ ‘ï¼‰ï¼šO(log n)
	â€¢	æœ€åæƒ…å†µï¼ˆé€€åŒ–ä¸ºé“¾è¡¨ï¼‰ï¼šO(n)


ç»†èŠ‚ä¸æ˜“é”™ç‚¹
	â€¢	è®¿é—®é¡ºåºå¿…é¡»æ˜¯ å³ â†’ å·¦ï¼Œè‹¥å†™æˆå·¦â†’å³ï¼Œåˆ™é¦–æ¬¡è®¿é—®åˆ°çš„æ˜¯æœ€å·¦èŠ‚ç‚¹ï¼Œå˜æˆâ€œå·¦è§†å›¾â€ã€‚
	â€¢	depth ä» 0 å¼€å§‹ï¼Œå¯¹åº”æ ¹èŠ‚ç‚¹çš„å±‚æ•°ã€‚
	â€¢	ç©ºæ ‘æ—¶ç›´æ¥è¿”å›ç©ºæ•°ç»„ã€‚

â¸»

11.1.4 è§£æ³•äºŒï¼šBFSï¼ˆå±‚åºéå†ï¼Œåªè®°å½•æ¯å±‚æœ€åä¸€ä¸ªï¼‰
æ ¸å¿ƒæ€æƒ³ï¼š
	â€¢	ä½¿ç”¨é˜Ÿåˆ—è¿›è¡Œå±‚åºéå†ï¼ˆBFSï¼‰ï¼Œæ¯ä¸€è½®å¤„ç†ä¸€æ•´å±‚ã€‚
	â€¢	å¯¹äºæ¯ä¸€å±‚ï¼š
	â€¢	ä»å·¦åˆ°å³ä¾æ¬¡å‡ºé˜Ÿï¼›
	â€¢	ç”¨ä¸€ä¸ªå˜é‡ rightmost ä¸æ–­è¦†ç›–å½“å‰èŠ‚ç‚¹å€¼ï¼›
	â€¢	è¿™ä¸€å±‚éå†å®Œæˆåï¼Œrightmost å°±æ˜¯è¯¥å±‚æœ€å³èŠ‚ç‚¹çš„å€¼ã€‚

æ— éœ€ä¿å­˜æ¯å±‚çš„å®Œæ•´èŠ‚ç‚¹åˆ—è¡¨ vector<vector<int>>ï¼Œåªéœ€è¦è®°å½•æ¯å±‚çš„â€œæœ€åä¸€ä¸ªâ€ã€‚


ä»£ç å®ç°ï¼ˆC++ï¼‰
```cpp
class Solution {
public:
    vector<int> rightSideView(TreeNode* root) {
        vector<int> ans;
        if (!root) return ans;

        queue<TreeNode*> q;
        q.push(root);

        while (!q.empty()) {
            int size = q.size();
            int rightmost = 0;  // å½“å‰å±‚æœ€å³èŠ‚ç‚¹çš„å€¼

            for (int i = 0; i < size; i++) {
                TreeNode* node = q.front();
                q.pop();

                // ä¸æ–­è¦†ç›–ï¼Œå½“æœ¬å±‚å¾ªç¯ç»“æŸæ—¶ï¼Œrightmost å³ä¸ºæœ€åè®¿é—®çš„é‚£ä¸ªèŠ‚ç‚¹
                rightmost = node->val;

                if (node->left)  q.push(node->left);
                if (node->right) q.push(node->right);
            }

            ans.push_back(rightmost);
        }

        return ans;
    }
};
```

â¸»

æ­£ç¡®æ€§è¯´æ˜è¦ç‚¹
	1.	å±‚åºéå†ä¿è¯â€œæŒ‰å±‚è®¿é—®â€
é˜Ÿåˆ—ä¸­æ¯ä¸€è½®å›ºå®šå¤„ç†ä¸€å±‚èŠ‚ç‚¹ï¼Œsize = q.size() å³å½“å‰å±‚èŠ‚ç‚¹æ•°ã€‚
	2.	å·¦ â†’ å³ å…¥é˜Ÿï¼Œå³èŠ‚ç‚¹åœ¨å½“å‰å±‚æœ€åè®¿é—®
	â€¢	å…¥é˜Ÿé¡ºåºä¸º left å† rightï¼›
	â€¢	å‡ºé˜Ÿæ—¶ï¼Œè¯¥å±‚å³ä¾§èŠ‚ç‚¹æ€»æ˜¯åè¿›å…¥é˜Ÿåˆ—ã€åå‡ºé˜Ÿï¼›
	â€¢	rightmost åœ¨è¯¥å±‚å¾ªç¯ä¸­ä¸æ–­è¢«è¦†ç›–ï¼Œå¾ªç¯ç»“æŸæ—¶ä¸ºè¯¥å±‚æœ€åä¸€ä¸ªå‡ºé˜ŸèŠ‚ç‚¹ï¼Œå³æœ€å³èŠ‚ç‚¹ã€‚
	3.	ä¸éœ€è¦ä¿å­˜æ•´å±‚èŠ‚ç‚¹
ç›¸æ¯”äº vector<vector<int>> ä¿å­˜å…¨å±‚åå†å– back() çš„æ–¹å¼ï¼Œè¯¥æ–¹æ³•åªä¿ç•™ä¸€ä¸ªå˜é‡ rightmostï¼Œç©ºé—´æ›´ä¼˜ã€‚

â¸»

å¤æ‚åº¦åˆ†æ
	â€¢	æ—¶é—´å¤æ‚åº¦ï¼š O(n)
æ¯ä¸ªèŠ‚ç‚¹ä»…å…¥é˜Ÿå’Œå‡ºé˜Ÿå„ä¸€æ¬¡ã€‚
	â€¢	ç©ºé—´å¤æ‚åº¦ï¼š O(n)
æœ€åæƒ…å†µä¸‹ï¼ˆå®Œå…¨äºŒå‰æ ‘ï¼‰ï¼Œé˜Ÿåˆ—ä¸­ä¼šå­˜åœ¨çº¦ n/2 ä¸ªèŠ‚ç‚¹ï¼Œæ•…ä¸º O(n)ã€‚

â¸»

11.1.5 ä¸â€œä¿å­˜æ•´å±‚å†å–æœ€åä¸€ä¸ªâ€çš„å†™æ³•å¯¹æ¯”
ä¸€ç§ç›´è§‚ä½†ä¸å¤Ÿé«˜æ•ˆçš„å†™æ³•æ˜¯ï¼š
	1.	ç”¨ BFS æ”¶é›†æ¯å±‚æ‰€æœ‰èŠ‚ç‚¹å€¼ï¼Œå­˜å…¥ vector<vector<int>> levelsã€‚
	2.	éå† levelsï¼Œä»æ¯å±‚ä¸­å–æœ€åä¸€ä¸ªå…ƒç´  levels[i].back() ä½œä¸ºå³è§†å›¾ç»“æœã€‚

ä¼ªä»£ç ç¤ºæ„ï¼š
```cpp
vector<int> rightSideView(TreeNode* root) {
    vector<vector<int>> levels;
    vector<int> ans;
    if (!root) return ans;

    queue<TreeNode*> q;
    q.push(root);

    while (!q.empty()) {
        int size = q.size();
        levels.push_back(vector<int>());

        for (int i = 0; i < size; i++) {
            TreeNode* node = q.front();
            q.pop();
            levels.back().push_back(node->val);

            if (node->left)  q.push(node->left);
            if (node->right) q.push(node->right);
        }
    }

    for (auto& vec : levels) {
        ans.push_back(vec.back());
    }

    return ans;
}
```
ä¸ä¸Šä¸€èŠ‚ä¼˜åŒ–ç‰ˆå¯¹æ¯”ï¼š
	â€¢	ç›¸åŒç‚¹ï¼š
	â€¢	éå†é¡ºåºç›¸åŒï¼šå±‚åº + å·¦åˆ°å³ï¼›
	â€¢	æ‰€å¾—ç­”æ¡ˆä¸€è‡´ã€‚
	â€¢	ä¸åŒç‚¹ï¼š
	â€¢	ä¼˜åŒ–ç‰ˆåªç”¨ä¸€ä¸ª rightmost å˜é‡ï¼Œä¸ä¿å­˜æ•´å±‚ï¼›
	â€¢	ä¸Šè¿°å†™æ³•éœ€è¦é¢å¤–çš„ vector<vector<int>> ä¿å­˜æ¯å±‚æ‰€æœ‰èŠ‚ç‚¹å€¼ï¼Œç©ºé—´å¼€é”€æ›´å¤§ï¼›
	â€¢	ä¼˜åŒ–ç‰ˆå‡å°‘ä¸€æ¬¡å¯¹ levels çš„éå†ï¼Œå¸¸æ•°å¼€é”€ç•¥å°ã€‚

å› æ­¤ï¼Œåœ¨åªå…³å¿ƒâ€œæ¯å±‚æœ€å³èŠ‚ç‚¹â€çš„åœºæ™¯ä¸‹ï¼Œæ¨èä½¿ç”¨ï¼š
	â€¢	BFSï¼šä»…è®°å½•æ¯å±‚æœ€åä¸€ä¸ªèŠ‚ç‚¹
	â€¢	æˆ– DFSï¼šè®°å½•æ¯å±‚é¦–æ¬¡è®¿é—®çš„èŠ‚ç‚¹ï¼ˆå³ä¼˜å…ˆï¼‰

â¸»

11.1.6 è¾¹ç•Œæƒ…å†µä¸æµ‹è¯•ç”¨ä¾‹
ç¼–å†™æˆ–è°ƒè¯•æ—¶å»ºè®®è¦†ç›–å¦‚ä¸‹æµ‹è¯•ï¼š
	1.	ç©ºæ ‘
è¾“å…¥ï¼šroot = nullptr
è¾“å‡ºï¼š[]
	2.	åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹1
è¾“å‡ºï¼š[1]
	3.	å®Œå…¨å·¦å€¾æ ‘
```
    1
   /
  2
 /
3
```
è¾“å‡ºï¼š[1, 2, 3]


	4.	å®Œå…¨å³å€¾æ ‘
```
1
 \
  2
   \
    3
```
è¾“å‡ºï¼š[1, 2, 3]


	5.	ä¸å®Œå…¨äºŒå‰æ ‘ï¼ˆæœ‰ç¼ºå¤±èŠ‚ç‚¹ï¼‰
```
    1
   / \
  2   3
   \
    5
```
è¾“å‡ºï¼š[1, 3, 5]



â¸»

11.1.7 å°ç»“ï¼šè§†å›¾ç±»é—®é¢˜çš„ç»Ÿä¸€æ¨¡å¼ï¼ˆä»¥å³è§†å›¾ä¸ºä¾‹ï¼‰
	â€¢	å³è§†å›¾çš„æœ¬è´¨ï¼šæ¯å±‚çš„æœ€å³èŠ‚ç‚¹ã€‚
	â€¢	DFS è§£æ³•åˆ©ç”¨â€œè®¿é—®é¡ºåº + ç¬¬ä¸€æ¬¡è®¿é—®â€çš„ç­–ç•¥ï¼š
	â€¢	å³ â†’ å·¦ï¼›
	â€¢	æ¯å±‚é¦–æ¬¡è®¿é—®å³ä¸ºæœ€å³èŠ‚ç‚¹ã€‚
	â€¢	BFS è§£æ³•åˆ©ç”¨â€œæŒ‰å±‚æ‰«æ + æœ€åè®¿é—®â€çš„ç­–ç•¥ï¼š
	â€¢	å·¦ â†’ å³ï¼›
	â€¢	æ¯å±‚æœ€åè®¿é—®å³ä¸ºæœ€å³èŠ‚ç‚¹ã€‚

å³è§†å›¾ä¸ºåç»­çš„ï¼š
	â€¢	å·¦è§†å›¾ï¼šæ¯å±‚â€œæœ€å·¦â€èŠ‚ç‚¹ï¼›
	â€¢	å…¶ä»–è§†å›¾é—®é¢˜ï¼ˆä¸Šè§†å›¾ / ä¸‹è§†å›¾ï¼‰ï¼›

æä¾›äº†ç»Ÿä¸€çš„æ€è€ƒæ¨¡æ¿ï¼š
â€œæŒ‰å±‚æ¬¡è®°å½•å…³é”®èŠ‚ç‚¹â€ + â€œæ§åˆ¶éå†é¡ºåºâ€ã€‚

ä¸‹é¢ç»™ä½ ä¸€ä»½**ä» `## 12. äºŒå‰æ ‘çš„é€’å½’` å¼€å§‹çš„ç¬”è®°**ã€‚
æˆ‘ä¼šä¿æŒä½ ä¹‹å‰å†™ä½œçš„é£æ ¼ï¼šç»“æ„æ¸…æ™°ã€æ€è·¯é€’è¿›ã€ä¾‹é¢˜è´¯ç©¿ï¼ŒåŒæ—¶æŠŠâ€œé€’å½’æ€æƒ³â€è®²å¾—å°½å¯èƒ½æœ¬è´¨åŒ–â€”â€”è®©å®ƒåƒä¸€æŠŠé’¥åŒ™ï¼Œèƒ½å¼€æ‰€æœ‰äºŒå‰æ ‘é¢˜ã€‚

è¯­æ°”æˆ‘ä¿æŒå¹³å®è§£é‡Šå¼ï¼Œä¸å¸¦æˆ‘è‡ªèº«çš„é£æ ¼å»æ±¡æŸ“ä½ çš„ç¬”è®°ã€‚

---

## 12. äºŒå‰æ ‘çš„é€’å½’

äºŒå‰æ ‘é¢˜çš„æ ¸å¿ƒæŠ€å·§å‡ ä¹éƒ½å¯ä»¥å½’ç»“ä¸ºä¸€å¥è¯ï¼š

> **é€’å½’çš„æœ¬è´¨ï¼Œå°±æ˜¯è®©å½“å‰èŠ‚ç‚¹æŠŠå®ƒè¯¥åšçš„äº‹åšå¥½ï¼Œç„¶åæŠŠå‰©ä¸‹çš„äº¤ç»™å®ƒçš„å·¦å³å­æ ‘ã€‚**

äºŒå‰æ ‘æœ¬èº«å°±æ˜¯é€’å½’ç»“æ„ï¼šæ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€æ£µâ€œæ›´å°çš„æ ‘â€ã€‚
å› æ­¤ç®—æ³•å¤©ç„¶é€‚åˆé€’å½’æè¿°ã€‚

åœ¨äºŒå‰æ ‘ä¸­ï¼Œé€’å½’ä¸€èˆ¬åˆ†ä¸ºä¸¤ç±»æ€ç»´æ–¹å¼ï¼š

---

### 12.1 ä¸¤ç±»ç»å…¸é€’å½’æ€ç»´æ¨¡å¼

#### **ï¼ˆ1ï¼‰è‡ªé¡¶å‘ä¸‹ï¼ˆTop-Downï¼‰â€”â€”â€œä»çˆ¶åˆ°å­â€é€å±‚ä¼ é€’ä¿¡æ¯**

å¸¸è§æ“ä½œï¼šè·¯å¾„é•¿åº¦ã€æ·±åº¦è®¡æ•°ã€ç´¯ç§¯å€¼ã€çº¦æŸæ¡ä»¶ä¼ é€’ã€‚

å†™æ³•ç‰¹å¾ï¼šé€’å½’å‡½æ•°å‚æ•°é‡Œä¼šä¼ é€’çŠ¶æ€ï¼Œä¾‹å¦‚å½“å‰æ·±åº¦ã€å½“å‰è·¯å¾„å’Œç­‰ã€‚

æ¡†æ¶å¦‚ä¸‹ï¼š

```cpp
void dfs(TreeNode* node, int param...) {
    if (!node) return;

    // åœ¨è¿›å…¥å­æ ‘ä¹‹å‰å¤„ç†å½“å‰èŠ‚ç‚¹
    do_something(node, param);

    // å°†å¤„ç†åçš„çŠ¶æ€ä¼ ç»™å­æ ‘
    dfs(node->left,  new_param1...);
    dfs(node->right, new_param2...);
}
```

å…¸å‹ä¾‹é¢˜ï¼š

* äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦ï¼ˆTop-Down å†™æ³•ï¼‰
* è·¯å¾„å’Œé—®é¢˜ï¼ˆ113, 112, 129ï¼‰

è¿™ç±»é€‚åˆâ€œè·¯å¾„é£æ ¼â€çš„é¢˜ã€‚

---

#### **ï¼ˆ2ï¼‰è‡ªåº•å‘ä¸Šï¼ˆBottom-Upï¼‰â€”â€”â€œç”±å­åˆ°çˆ¶â€æ±‡æ€»å­æ ‘ç»“æœ**

å¸¸è§æ“ä½œï¼šé«˜åº¦ã€ç›´å¾„ã€æ˜¯å¦å¹³è¡¡ã€æœ€å¤§ BST å­æ ‘ã€å¯¹ç§°æ€§ç­‰ã€‚

å†™æ³•ç‰¹å¾ï¼š
é€’å½’è¿”å›å€¼æ˜¯ä¸€ä¸ªç»“æ„ï¼Œç”¨äºæè¿°â€œå½“å‰å­æ ‘â€çš„ä¿¡æ¯ã€‚

æ¡†æ¶å¦‚ä¸‹ï¼š

```cpp
Result dfs(TreeNode* node) {
    if (!node) return base_case;

    Result L = dfs(node->left);
    Result R = dfs(node->right);

    // åŸºäºå·¦å³å­æ ‘æ„å»ºå½“å‰èŠ‚ç‚¹ç»“æœ
    return merge(L, R, node);
}
```

å…¸å‹ä¾‹é¢˜ï¼š

* æ˜¯å¦å¹³è¡¡ (110)
* æœ€å¤§æ·±åº¦ï¼ˆBottom-Up å†™æ³•ï¼‰
* äºŒå‰æ ‘çš„ç›´å¾„ (543)
* å¯¹ç§°äºŒå‰æ ‘ï¼ˆä½ çš„ä¹‹å‰é‚£ä¸ª check å†™æ³•å°±æ˜¯ Bottom-Upï¼‰

è¿™ç±»é€‚åˆâ€œæ±‡æ€»å‹â€çš„é¢˜ã€‚

---

### 12.2 é€’å½’çš„ä¸‰è¦ç´ ï¼ˆæ¡†æ¶ï¼‰

å¤§å¤šæ•°äºŒå‰æ ‘é€’å½’éƒ½èƒ½è¢«æ‹†æˆ 3 ä¸ªéƒ¨åˆ†ï¼š

1. **æ˜ç¡®å‡½æ•°å«ä¹‰ï¼ˆè¿”å›å€¼ã€å‚æ•°ï¼‰**

   * è¿™ä¸€æ­¥æœ€å…³é”®
   * ä¸€æ—¦å«ä¹‰æ˜ç¡®ï¼Œä»£ç å‡ ä¹è‡ªåŠ¨å®Œæˆ

2. **å†™ç»ˆæ­¢æ¡ä»¶**

   * é‡åˆ°ç©ºèŠ‚ç‚¹è¿”å›ä»€ä¹ˆï¼Ÿ
   * é‡åˆ°å¶å­èŠ‚ç‚¹æ˜¯å¦è¦ç‰¹æ®Šå¤„ç†ï¼Ÿ

3. **åˆ©ç”¨å·¦å³å­æ ‘çš„é€’å½’ç»“æœå¾—åˆ°å½“å‰ç­”æ¡ˆ**

   * é€’å½’çš„æ ¸å¿ƒå°±æ˜¯è¿™ä¸€æ­¥
   * å·¦å­æ ‘ç»™ä½ ä¸€ä¸ªç»“æœï¼Œå³å­æ ‘ç»™ä½ ä¸€ä¸ªç»“æœ
   * ä½ åªéœ€â€œç»„åˆâ€å®ƒä»¬

æ•´ä¸ªè¿‡ç¨‹åƒæ­ç§¯æœ¨ã€‚

---

### 12.3 é‡åˆ°äºŒå‰æ ‘é€’å½’é¢˜çš„æ€è€ƒæµç¨‹

æŠŠé¢˜ç›®æ”¾åœ¨ä¸€è¾¹ï¼Œåªæƒ³ä»¥ä¸‹ 4 ä¸ªé—®é¢˜ï¼š

1. **å‡½æ•°çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ**

   * â€œè¿”å›å½“å‰å­æ ‘çš„é«˜åº¦â€
   * â€œè¿”å›å½“å‰å­æ ‘æ˜¯å¦å¹³è¡¡â€
   * â€œè¿”å›ä» root åˆ°å½“å‰èŠ‚ç‚¹çš„è·¯å¾„å’Œâ€
   * æ˜ç¡®åé—®é¢˜å°±æ¸…æ™°äº†

2. **ç©ºèŠ‚ç‚¹æ€ä¹ˆå¤„ç†ï¼Ÿ**

   * è¿”å› 0ï¼Ÿ
   * è¿”å› trueï¼Ÿ
   * è¿”å›ç©ºç»“æ„ï¼Ÿ

3. **å·¦å³å­æ ‘æ€ä¹ˆé€’å½’ï¼Ÿ**

4. **å¦‚ä½•ç”±å·¦å³å­æ ‘çš„ç»“æœæ¨å¯¼å½“å‰èŠ‚ç‚¹çš„ç­”æ¡ˆï¼Ÿ**

æ¯é“é¢˜éƒ½å¯ä»¥è¿™æ ·æ‹†ã€‚

---

### 12.4 ä»é¢˜å•ä¸­æŒ‘å…¸å‹é¢˜ä½œä¸ºé€’å½’æ¨¡æ¿

ä¸‹é¢ä»ä½ æˆªå›¾ä¸­çš„é¢˜å•æŒ‘ä¸€äº›ä½œä¸ºé€’å½’æ¨¡æ¿ï¼ŒæŒ‰é€»è¾‘é€’è¿›ã€‚

---

#### 12.4.1 å‰åº / ä¸­åº / ååºéå†ï¼ˆ144 / 145 / 94ï¼‰

è¿™äº›æ˜¯æœ€åŸºæœ¬çš„é€’å½’å…¥é—¨å†™æ³•ã€‚

å‰åºéå†ï¼š

```cpp
void preorder(TreeNode* root, vector<int>& res) {
    if (!root) return;
    res.push_back(root->val);
    preorder(root->left, res);
    preorder(root->right, res);
}
```

ç»“æ„æ¸…æ™°ï¼Œé€‚åˆä½œä¸ºâ€œé€’å½’æ¡†æ¶çš„ç¬¬ä¸€è¯¾â€ã€‚

---

### 12.4.2 äºŒå‰æ ‘æœ€å¤§æ·±åº¦ï¼ˆ104ï¼‰

Bottom-Upï¼š

```cpp
int maxDepth(TreeNode* root) {
    if (!root) return 0;
    return 1 + max(maxDepth(root->left), maxDepth(root->right));
}
```

è¿™å°±æ˜¯æœ€å…¸å‹çš„â€œå·¦å³å­æ ‘è¿”å›é«˜åº¦ã€å½“å‰èŠ‚ç‚¹å–æœ€å¤§â€ã€‚

---

#### 12.4.3 å¯¹ç§°äºŒå‰æ ‘ï¼ˆ101ï¼‰

ä½ çš„ä»£ç æ­£æ˜¯ Bottom-Upã€‚

æŠŠå®ƒå†™æˆå•å‡½æ•°ä¹Ÿå¯ä»¥ï¼š

```cpp
bool isSymmetric(TreeNode* root) {
    function<bool(TreeNode*, TreeNode*)> check = [&](TreeNode* p, TreeNode* q) {
        if (!p && !q) return true;
        if (!p || !q) return false;
        return p->val == q->val &&
               check(p->left, q->right) &&
               check(p->right, q->left);
    };
    return check(root->left, root->right);
}
```

é€’å½’æœ¬è´¨ï¼š
**å¯¹ç§° = å·¦å­æ ‘çš„å·¦ ä¸ å³å­æ ‘çš„å³ å¯¹ç§° + å·¦å­æ ‘çš„å³ ä¸ å³å­æ ‘çš„å·¦ å¯¹ç§°ã€‚**

---

#### 12.4.4 æ˜¯å¦å¹³è¡¡äºŒå‰æ ‘ï¼ˆ110ï¼‰

æœ€èƒ½ä½“ç°è¿”å›ç»“æ„ä½“æ€æƒ³ï¼š

```cpp
int dfs(TreeNode* root) {
    if (!root) return 0;

    int L = dfs(root->left);
    int R = dfs(root->right);
    if (L == -1 || R == -1 || abs(L - R) > 1) return -1;
    return max(L, R) + 1;
}

bool isBalanced(TreeNode* root) {
    return dfs(root) != -1;
}
```

è¿™ç§ â€œè¿”å›é«˜åº¦ + ç‰¹æ®Šå€¼è¡¨ç¤ºéæ³•â€ çš„å†™æ³•å¾ˆå¸¸ç”¨ã€‚
ä¸‹é¢æ˜¯æˆ‘çš„å†™æ³•ï¼š
```cpp
int maxdepth(TreeNode* root)
    {
        if(!root)return 0;
        return max(maxdepth(root->left),maxdepth(root->right))+1;
    }
    bool isBalanced(TreeNode* root) {
        if(!root)
        return true;
        int a=maxdepth(root->right)-maxdepth(root->left);
        int b=maxdepth(root->left)-maxdepth(root->right);
        if(a>1||b>1)
        return false;
        return isBalanced(root->left)&&isBalanced(root->right);
    }
```

---

#### 12.4.5 äºŒå‰æ ‘ç›´å¾„ï¼ˆ543ï¼‰

ç»å…¸â€œå·¦å³å­æ ‘è´¡çŒ®â€é—®é¢˜ï¼š

```cpp
int diameter = 0;

int dfs(TreeNode* root) {
    if (!root) return 0;

    int L = dfs(root->left);
    int R = dfs(root->right);

    diameter = max(diameter, L + R);
    return 1 + max(L, R);
}
```

**ç›´å¾„ = å·¦å­æ ‘é«˜åº¦ + å³å­æ ‘é«˜åº¦ã€‚**

---

#### 12.4.6 è·¯å¾„å’Œ I / II / IIIï¼ˆ112 / 113 / 437ï¼‰

Top-Down çš„å…¸å‹ï¼š

```cpp
bool hasPathSum(TreeNode* root, int target) {
    if (!root) return false;
    if (!root->left && !root->right) return root->val == target;
    return hasPathSum(root->left, target - root->val) ||
           hasPathSum(root->right, target - root->val);
}
```

é€’å½’åœ¨è·¯å¾„ç±»é¢˜é‡Œéå¸¸è‡ªç„¶ï¼š
è·¯å¾„ä¹‹å’Œç”±çˆ¶èŠ‚ç‚¹å†³å®šå­èŠ‚ç‚¹çš„â€œå‰©ä½™ç›®æ ‡â€ã€‚

---
### 12.5 é€šè¿‡å…ˆåºï¼Œä¸­åºï¼Œååºæ„å»ºäºŒå‰æ ‘ï¼ˆ105 / 106 / 889ï¼‰
å…¸å‹çš„é€’å½’æ„å»ºé—®é¢˜ï¼š

```cpp  
TreeNode* buildTree(vector<int>& preorder, int preStart, int preEnd,
                    vector<int>& inorder, int inStart, int inEnd,
                    unordered_map<int, int>& inIndex) {
    if (preStart > preEnd || inStart > inEnd) return nullptr;

    int rootVal = preorder[preStart];
    TreeNode* root = new TreeNode(rootVal);
    int inRootIndex = inIndex[rootVal];
    int leftSize = inRootIndex - inStart;

    root->left = buildTree(preorder, preStart + 1, preStart + leftSize,
                           inorder, inStart, inRootIndex - 1, inIndex);
    root->right = buildTree(preorder, preStart + leftSize + 1, preEnd,
                            inorder, inRootIndex + 1, inEnd, inIndex);
    return root;
}
```
---
### 12.6 æ€»ç»“ï¼šäºŒå‰æ ‘é€’å½’çš„ç»Ÿä¸€è§†è§’

æ— è®ºé¢˜ç›®æ˜¯ä»€ä¹ˆï¼Œä½ éƒ½èƒ½æŠŠå®ƒå½’å…¥ä¸‹é¢ä»»æ„ä¸€ç±»ï¼š

1. **éå†å‹ï¼ˆè®¿é—®æ¯ä¸ªèŠ‚ç‚¹ï¼‰**

   * å‰åºã€ä¸­åºã€ååºã€æ±‚å¹³å‡å€¼ã€ç»Ÿè®¡èŠ‚ç‚¹æ•°ç­‰
   * æ¡†æ¶ï¼šè®¿é—®å½“å‰èŠ‚ç‚¹ â†’ é€’å½’å·¦å³

2. **æ±‡æ€»å‹ï¼ˆå­æ ‘ç»“æœç»„åˆï¼‰**

   * é«˜åº¦ã€ç›´å¾„ã€æ˜¯å¦å¹³è¡¡ã€æ˜¯å¦å¯¹ç§°
   * æ¡†æ¶ï¼šé€’å½’å·¦å³å­æ ‘ â†’ åˆå¹¶ä¸¤ä¾§ç»“æœ

3. **è·¯å¾„å‹ï¼ˆåœ¨å‚æ•°ä¸­ä¼ çŠ¶æ€ï¼‰**

   * è·¯å¾„å’Œã€å‰åºè·¯å¾„ã€å›æº¯
   * æ¡†æ¶ï¼šå‚æ•°å¸¦çŠ¶æ€ â†’ é€’å½’ä¼ é€’çŠ¶æ€

åªè¦ä½ è¯†åˆ«å‡ºé¢˜ç›®å±äºå“ªä¸€ç±»ï¼Œé€’å½’è§£æ³•å‡ ä¹è‡ªåŠ¨æˆå‹ã€‚

---
## 13. äºŒå‰æœç´¢æ ‘çš„æœ€å°ç»å¯¹å·®ï¼ˆ530ï¼‰
é¢˜ç›®é“¾æ¥ï¼š[530. Minimum Absolute Difference in BST](https://leetcode.cn/problems/minimum-absolute-difference-in-bst/)

---

### ä¸­åºéå†æ±‚äºŒå‰æœç´¢æ ‘æœ€å°ç»å¯¹å·®

### æ€è·¯ä¸æ ¸å¿ƒåŸç†

äºŒå‰æœç´¢æ ‘ï¼ˆBSTï¼‰çš„å…³é”®æ€§è´¨æ˜¯ï¼š

**ä¸­åºéå†åºåˆ—æ˜¯ä¸¥æ ¼é€’å¢çš„ã€‚**

å¦‚æœå°†æ•´æ£µ BST ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹æŒ‰ä¸­åºéå†åˆ—æˆæ•°ç»„ï¼š

```
a[0] < a[1] < a[2] < ... < a[n-1]
```

é‚£ä¹ˆæœ€å°ç»å¯¹å·®å¿…ç„¶æ¥è‡ªæŸä¸€å¯¹ **ç›¸é‚»å…ƒç´ **ï¼š

```
min( a[i+1] - a[i] )
```

åŸå› å¾ˆç®€å•ï¼š
ä¸€æ—¦è·³è¿‡ç›¸é‚»å…³ç³»å»æ¯”è¾ƒæ›´è¿œçš„ä¸¤ä¸ªå…ƒç´ ï¼Œæ¯”å¦‚ `(a[i], a[i+2])`ï¼Œå®ƒä»¬ä¹‹é—´çš„å·®å¿…ç„¶æ›´å¤§ã€‚

åŸºäºè¿™ä¸€æ€§è´¨ï¼Œé—®é¢˜å°±å˜æˆï¼š

> åœ¨ä¸ç ´å BST ç»“æ„çš„å‰æä¸‹è·å–â€œæœ‰åºåºåˆ—é‡Œçš„ç›¸é‚»å·®â€ã€‚

---

### ä¸¤ç§æ–¹å¼å®ç°

1ï¼‰**å…ˆä¸­åºéå†å­˜åˆ°æ•°ç»„ï¼Œå†éå†æ•°ç»„æ±‚ç›¸é‚»å·®å€¼ã€‚**
è¿™ç§å¯è¡Œï¼Œä½†éœ€è¦é¢å¤–æ•°ç»„ç©ºé—´ã€‚

2ï¼‰**ç›´æ¥åœ¨ä¸­åºéå†è¿‡ç¨‹ä¸­ï¼Œç”¨ pre ä¿å­˜ä¸Šä¸€ä¸ªè®¿é—®åˆ°çš„èŠ‚ç‚¹å€¼ã€‚**
è¿™æ ·éå†åˆ°å½“å‰èŠ‚ç‚¹æ—¶ï¼Œä¸ pre ç›¸å‡å³å¯å¾—åˆ°å½“å‰çš„ç›¸é‚»å·®å€¼ï¼Œç©ºé—´æ›´çœã€‚

ä¸ºäº†æ ‡è®°â€œè¿˜æ²¡æœ‰å‰é©±â€ï¼Œé€šå¸¸æŠŠ `pre` åˆå§‹åŒ–ä¸ºä¸€ä¸ªæ— æ•ˆå€¼ï¼Œè¿™é‡Œç”¨ `-1`ï¼ˆåªè¦ç¡®å®šä¸ä¼šæ˜¯ BST ä¸­åˆæ³•å€¼å³å¯ï¼‰ã€‚

---

### é€’å½’ä¸­åºéå†çš„å†™æ³•

ä»£ç é€»è¾‘éå¸¸ç®€å•ï¼š

* é€’å½’è®¿é—®å·¦å­æ ‘
* ç”¨ pre æ›´æ–°ç»“æœ ans
* æ›´æ–° pre
* é€’å½’è®¿é—®å³å­æ ‘

è¿™æ­£æ˜¯ä¸­åºéå†å¯¹åº”çš„â€œå·¦ â†’ æ ¹ â†’ å³â€é¡ºåºã€‚

---

### ä»£ç ï¼ˆC++ï¼‰

```cpp
class Solution {
public:
    void dfs(TreeNode* root, int& pre, int& ans) {
        if (root == nullptr) {
            return;
        }
        dfs(root->left, pre, ans);
        if (pre == -1) {
            pre = root->val;   // ç¬¬ä¸€ä¸ªç‚¹ï¼Œåªè®°å½•ä¸æ¯”è¾ƒ
        } else {
            ans = min(ans, root->val - pre);
            pre = root->val;   // æ›´æ–°å‰é©±
        }
        dfs(root->right, pre, ans);
    }

    int getMinimumDifference(TreeNode* root) {
        int ans = INT_MAX, pre = -1;
        dfs(root, pre, ans);
        return ans;
    }
};
```

---

### å¤æ‚åº¦åˆ†æ

**æ—¶é—´å¤æ‚åº¦ï¼šO(n)**
æ¯ä¸ªèŠ‚ç‚¹åªè®¿é—®ä¸€æ¬¡ã€‚

**ç©ºé—´å¤æ‚åº¦ï¼šO(n)**
å–å†³äºé€’å½’æ·±åº¦ï¼š

* å¦‚æœæ ‘é€€åŒ–æˆé“¾ï¼Œåˆ™æ·±åº¦ä¸º nï¼›
* è‹¥æ ‘å¹³è¡¡ï¼Œåˆ™æ·±åº¦ä¸º log nï¼›
  æœ€åæƒ…å†µä¸º O(n)ã€‚

---

## 14. äºŒå‰æ ‘ & äºŒå‰æœç´¢æ ‘ï¼šæœ€è¿‘å…¬å…±ç¥–å…ˆï¼ˆLowest Common Ancestor, LCAï¼‰

æœ¬ç« è®²çš„æ˜¯ LeetCode ç»å…¸åŒé¢˜ï¼š

[æ™®é€šäºŒå‰æ ‘çš„ LCA](https://leetcode.cn/problems/lowest-common-ancestor-of-a-binary-tree/)

[äºŒå‰æœç´¢æ ‘çš„ LCA](https://leetcode.cn/problems/lowest-common-ancestor-of-a-binary-search-tree/)


ä¸¤é¢˜é€»è¾‘æ¡†æ¶å®Œå…¨ä¸åŒï¼Œå› æ­¤éå¸¸é€‚åˆä½œä¸ºæ ‘ç»“æ„ç†è§£çš„åˆ†ç•Œçº¿ã€‚

---

### 14.1 æœ€è¿‘å…¬å…±ç¥–å…ˆæ˜¯ä»€ä¹ˆï¼Ÿ

ç»™å®šä¸¤ä¸ªèŠ‚ç‚¹ `p` å’Œ `q`ï¼ŒLCAï¼ˆæœ€è¿‘å…¬å…±ç¥–å…ˆï¼‰å®šä¹‰ä¸ºï¼š

> åœ¨æ ‘ä¸­åŒæ—¶æ‹¥æœ‰ p å’Œ q ä½œä¸ºåä»£ï¼ˆèŠ‚ç‚¹æœ¬èº«ä¹Ÿè§†ä¸ºè‡ªå·±çš„åä»£ï¼‰çš„æœ€æ·±èŠ‚ç‚¹ã€‚

è¿™å¥è¯éšå«ä¸¤ä¸ªå…³é”®ç‚¹ï¼š

1. ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥æ˜¯è‡ªå·±çš„ç¥–å…ˆ
2. LCA æ˜¯ä¸¤æ¡è·¯å¾„ç¬¬ä¸€æ¬¡â€œæ±‡åˆâ€çš„åœ°æ–¹

---

### 14.2 äºŒå‰æœç´¢æ ‘çš„ LCAï¼ˆBST LCAï¼‰

#### **14.2.1 BST çš„æ’åºç»“æ„ï¼šä¸ºä»€ä¹ˆæ›´ç®€å•ï¼Ÿ**

BST æ»¡è¶³æ€§è´¨ï¼š

```
å·¦å­æ ‘æ‰€æœ‰å€¼ < root->val < å³å­æ ‘æ‰€æœ‰å€¼
```

è¿™æ„å‘³ç€ï¼š

* å¦‚æœ `p` å’Œ `q` çš„å€¼éƒ½æ¯” root å¤§ â†’ LCA åœ¨å³å­æ ‘
* å¦‚æœéƒ½æ¯” root å° â†’ LCA åœ¨å·¦å­æ ‘
* å¦åˆ™ â†’ root å°±æ˜¯åˆ†å‰ç‚¹ï¼Œä¹Ÿå°±æ˜¯ LCA

æ•´ä¸ªè¿‡ç¨‹åƒåŒæ—¶è¿½è¸ªä¸¤ä¸ªäººèµ°æ¥¼æ¢¯ï¼š
ä»–ä»¬å§‹ç»ˆå¾€åŒä¸€æ–¹å‘èµ°ï¼Œç›´åˆ°æŸå±‚æ¥¼çªç„¶ä¸å†ä¸€è‡´ï¼Œé‚£å°±æ˜¯æœ€è¿‘çš„äº¤æ±‡ã€‚

---

#### **14.2.2 é€’å½’è§£æ³•ï¼ˆæœ€ç»å…¸å½¢å¼ï¼‰**

```cpp
class Solution {
public:
    TreeNode* lowestCommonAncestor(TreeNode* root, TreeNode* p, TreeNode* q) {
        if (root->val < p->val && root->val < q->val)
            return lowestCommonAncestor(root->right, p, q);

        if (root->val > p->val && root->val > q->val)
            return lowestCommonAncestor(root->left, p, q);

        // åˆ†å‰ç‚¹ æˆ–ç­‰äº p/q
        return root;
    }
};
```

### æ€ç»´æ€»ç»“ï¼š

* **ä¸€æ—¦ä¸åœ¨åŒä¸€ä¾§ï¼Œå¿…ç„¶æ˜¯ç­”æ¡ˆ**
* **åªéœ€æ²¿ç€æ ‘å¾€ä¸‹èµ°ï¼Œä¸éœ€è¦å›æº¯ï¼Œä¹Ÿä¸éœ€è¦æŸ¥æ•´æ£µæ ‘**

---

#### **14.2.3 æ—¶é—´ & ç©ºé—´å¤æ‚åº¦**

* **æ—¶é—´**ï¼šO(h)ï¼Œh = æ ‘é«˜

  * å¹³è¡¡æ ‘ï¼šO(log n)
  * æœ€åçš„é“¾çŠ¶ï¼šO(n)
* **ç©ºé—´**ï¼šé€’å½’æ·±åº¦ O(h)

BST çš„ LCA å¯ä»¥ç†è§£ä¸ºè‡ªç„¶ä½¿ç”¨æ•°å€¼åˆ†å¸ƒçš„ä¸€ç§â€œäºŒåˆ†æœç´¢â€ã€‚

---

### 14.3 æ™®é€šäºŒå‰æ ‘çš„ LCAï¼ˆBinary Tree LCAï¼‰

æ²¡æœ‰æ’åºç»“æ„ â†’ åªèƒ½ä¾é  DFS å…¨æ ‘æœç´¢ï¼Œå¹¶é€šè¿‡â€œå›æº¯â€åˆ¤æ–­æŸä¸ªèŠ‚ç‚¹æ˜¯å¦æ˜¯ LCAã€‚

---

#### 14.3.1 ä¸ºä»€ä¹ˆæ™®é€šäºŒå‰æ ‘éœ€è¦ DFSï¼Ÿ

å› ä¸ºæ™®é€šäºŒå‰æ ‘æ²¡æœ‰é¡ºåºæ€§è´¨ï¼Œä½ æ— æ³•åˆ¤æ–­ p å’Œ q åœ¨æ ‘çš„å“ªä¸€ä¾§ï¼Œåªèƒ½è®©æ¯ä¸ªèŠ‚ç‚¹å›ç­”ä¸€ä¸ªé—®é¢˜ï¼š

**æˆ‘çš„å­æ ‘é‡Œæœ‰æ²¡æœ‰å‡ºç° p æˆ– qï¼Ÿ**

ç„¶ååˆ©ç”¨ DFS çš„è¿”å›å€¼å¾€ä¸Šå±‚æ±‡æŠ¥ã€‚

---

#### 14.3.2 å…³é”®é€»è¾‘ï¼šä¸‰ç§è§¦å‘ LCA çš„æƒ…å†µ

èŠ‚ç‚¹ `root` æ˜¯ LCA çš„æ¡ä»¶ï¼š

1. **å·¦å­æ ‘åŒ…å«ä¸€ä¸ªç›®æ ‡**ï¼Œå³å­æ ‘ä¹ŸåŒ…å«ä¸€ä¸ª

   ```
   lson == true && rson == true
   ```
2. **root è‡ªå·±å°±æ˜¯ p/qï¼Œä¸”å·¦å³å­æ ‘æœ‰ä¸€ä¸ªå‡ºç°äº†å¦ä¸€ä¸ªç›®æ ‡**

   ```
   (root==p æˆ– root==q) && (lson || rson)
   ```

è¿™ä¸¤ä¸ªæ¡ä»¶éƒ½æ„å‘³ç€ï¼š
**p å’Œ q ç¬¬ä¸€æ¬¡åœ¨æ­¤èŠ‚ç‚¹æ±‡åˆ**ã€‚

---

#### 14.3.3 ä»£ç ï¼ˆç»å…¸ DFS å›æº¯æ³•ï¼‰

```cpp
TreeNode* ans;

bool dfs(TreeNode* root, TreeNode* p, TreeNode* q)
{
    if (!root) return false;

    bool lson = dfs(root->left, p, q);
    bool rson = dfs(root->right, p, q);

    // å½“å‰èŠ‚ç‚¹æ˜¯å¦æ˜¯ç­”æ¡ˆ
    if ((lson && rson) ||
        ((root->val == p->val || root->val == q->val) && (lson || rson)))
        ans = root;

    // è¿”å›è¯¥å­æ ‘æ˜¯å¦åŒ…å« p æˆ– q
    return lson || rson || root->val == p->val || root->val == q->val;
}

TreeNode* lowestCommonAncestor(TreeNode* root, TreeNode* p, TreeNode* q) {
    dfs(root, p, q);
    return ans;
}
```

---

#### 14.3.4 ä»£ç é€»è¾‘æ‹†è§£

#### **1. dfs è¿”å›å¸ƒå°”å€¼**

å«ä¹‰æ˜¯ï¼šâ€œå½“å‰å­æ ‘æ˜¯å¦åŒ…å« p æˆ– qâ€ã€‚

#### **2. é€’å½’å¤©ç„¶åœ°æ„å»ºè‡ªåº•å‘ä¸Šçš„ä¿¡æ¯å›æµ**
æ¯å±‚éƒ½å¾—å‡º lson / rson æ˜¯å¦å­˜åœ¨ç›®æ ‡èŠ‚ç‚¹ã€‚

#### **3. LCA çš„åˆ¤æ–­æ¡ä»¶åˆ†æˆä¸¤ç±»è·¯å¾„**

* p å’Œ q åˆ†åˆ«åœ¨å·¦å³å­æ ‘ â†’ æ ¹èŠ‚ç‚¹æ˜¯æ±‡åˆç‚¹
* root æ˜¯ p/qï¼Œå…¶å­æ ‘åŒ…å«å¦ä¸€ä¸ª â†’ æ­¤å¤„å°±æ˜¯ç­”æ¡ˆ

å› æ­¤ä¿è¯äº† LCA åªä¼šè¢«èµ‹å€¼ä¸€æ¬¡ï¼Œè€Œä¸”æ˜¯ç¦»å¶å­æœ€è¿‘çš„é‚£æ¬¡ã€‚

---

### 14.4 BST LCA vs æ™®é€š LCA çš„æœ¬è´¨åŒºåˆ«

| ç‰¹æ€§        | BST LCA | æ™®é€šæ ‘ LCA        |
| --------- | ------- | -------------- |
| åˆ©ç”¨æ’åºå—     | æ˜¯       | å¦              |
| æ˜¯å¦éœ€è¦éå†æ•´æ£µæ ‘ | ä¸ä¸€å®š     | å¿…é¡»             |
| ç®—æ³•æ–¹å‘      | è‡ªé¡¶å‘ä¸‹æ‰¾åˆ†å‰ | è‡ªåº•å‘ä¸Šæ‰¾äº¤æ±‡        |
| æ˜¯å¦éœ€è¦å›æº¯    | å¦       | æ˜¯              |
| å¤æ‚åº¦       | O(h)    | O(n)           |
| æ˜¯å¦éœ€è¦è¾…åŠ©å˜é‡  | ä¸éœ€è¦     | éœ€è¦ï¼ˆè¿”å›å€¼ + å…¨å±€ç­”æ¡ˆï¼‰ |

å¯ä»¥ç†è§£ä¸ºï¼š

* **BSTï¼šé¡ºç€è·¯å¾„èµ°åˆ°åˆ†å²”ç‚¹å³å¯**
* **æ™®é€šæ ‘ï¼šå¿…é¡»æœå®Œæ•´æ£µæ ‘å¹¶åœ¨å›æº¯æ—¶åˆ¤æ–­**

ä¸¤è€…ç»“æ„æ–¹å‘å®Œå…¨ç›¸åã€‚

---

### 14.5 æ€ç»´å¯è§†åŒ–æ€»ç»“

#### **BSTï¼šåƒåœ¨æ’åºå¥½çš„æ¥¼å±‚é‡Œæ‰¾åˆ†å‰å£**

p å’Œ q çš„å€¼å§‹ç»ˆæŒ‡å¼•ä½ å¾€å·¦æˆ–å¾€å³èµ°ï¼Œç›´åˆ°æœ‰ä¸€å¤©ä¸¤ä¸ªæ–¹å‘ä¸ä¸€æ ·ï¼Œé‚£ä¹ˆä½ æ‰¾åˆ°äº†ç­”æ¡ˆã€‚

#### **æ™®é€šæ ‘ï¼šåƒä»å¶å­å¾€ä¸Šå›æº¯ä¿¡æ¯**

æ¯ä¸ªèŠ‚ç‚¹è´Ÿè´£é—®å­©å­ï¼šâ€œä½ ä»¬é‡Œé¢æœ‰æ²¡æœ‰æˆ‘æƒ³æ‰¾çš„äººï¼Ÿâ€
å½“ä¸¤ä¸ªå­æ ‘éƒ½å›ç­”â€œæœ‰â€ï¼Œæˆ–è€…è‡ªèº«å°±æ˜¯ç›®æ ‡ä¹‹ä¸€ï¼Œè€Œå­©å­ä¹Ÿä¼ æ¥ä¿¡å·æ—¶ï¼Œç­”æ¡ˆå°±å‡ºç°äº†ã€‚
è¿™ç§å›æº¯å¼çš„æ€ç»´æ–¹å¼è®©ä½ èƒ½åœ¨æ²¡æœ‰æ’åºç»“æ„çš„æƒ…å†µä¸‹æ‰¾åˆ°æœ€è¿‘çš„äº¤æ±‡ç‚¹ã€‚
ä¸‹é¢ç»™ä½ è¡¥ä¸Š **â€œç»Ÿä¸€ LCA æ¨¡æ¿ï¼ˆé€‚ç”¨äºæ™®é€šäºŒå‰æ ‘ï¼‰â€** çš„å®Œæ•´è¡¥å……ç« èŠ‚ï¼Œä½œä¸º **##14 çš„å»¶ä¼¸å†…å®¹**ã€‚
è¿™ä¸ªæ¨¡æ¿åœ¨åç»­æ‰€æœ‰ LCA å˜ä½“é¢˜é‡Œéƒ½èƒ½ç›´æ¥ä½¿ç”¨ï¼Œéå¸¸å®ç”¨ã€‚

---

### 14.6 ç»Ÿä¸€æ¨¡æ¿ï¼šè¿”å›èŠ‚ç‚¹æŒ‡é’ˆçš„ DFSï¼ˆBinary Tree é€šç”¨ LCA æ¨¡æ¿ï¼‰

ä¸Šé¢çš„ 14.3 ç”¨çš„æ˜¯â€œè¿”å›å¸ƒå°”å€¼ + å…¨å±€å˜é‡â€çš„å†™æ³•ï¼Œè¿™æ˜¯ LeetCode å®˜æ–¹æ¨èä¹‹ä¸€ï¼Œä½†åœ¨æ›´å¤æ‚çš„é¢˜é‡Œï¼Œæœ‰æ—¶æˆ‘ä»¬å¸Œæœ› DFS ç›´æ¥è¿”å›â€œè¿™ä¸ªå­æ ‘æ˜¯å¦åŒ…å« LCA æœ¬èº«çš„æŒ‡é’ˆâ€ã€‚

äºæ˜¯æˆ‘ä»¬ä¼šç”¨åˆ°ä¸‹é¢è¿™ç§æ›´ç»å…¸ã€æ›´ç®€æ´çš„ **â€œè¿”å›èŠ‚ç‚¹æŒ‡é’ˆâ€** æ¨¡æ¿ï¼š

---

#### 14.6.1 æ ¸å¿ƒæ€æƒ³ï¼šè®©é€’å½’ç›´æ¥è¿”å› LCA

å‡½æ•°è®¾è®¡ï¼š

```
dfs(root) è¿”å›ï¼š
- å¦‚æœ root å­æ ‘ä¸­æ‰¾åˆ° p æˆ– qï¼Œåˆ™è¿”å›é‚£ä¸ªèŠ‚ç‚¹
- å¦‚æœåœ¨å·¦å³å­æ ‘éƒ½æ‰¾åˆ°ï¼Œåˆ™ root å°±æ˜¯ç­”æ¡ˆ
```

è¿™ç§å†™æ³•ä¸éœ€è¦å…¨å±€å˜é‡ï¼Œä¹Ÿä¸éœ€è¦å¤æ‚å¸ƒå°”åˆ¤æ–­ã€‚

---

#### 14.6.2 æ¨¡æ¿ä»£ç ï¼ˆå¼ºçƒˆæ¨èæ‰‹èƒŒä¼šå†™ï¼‰

```cpp
TreeNode* lowestCommonAncestor(TreeNode* root, TreeNode* p, TreeNode* q) {
    if (!root || root == p || root == q)
        return root;

    TreeNode* left  = lowestCommonAncestor(root->left,  p, q);
    TreeNode* right = lowestCommonAncestor(root->right, p, q);

    // æƒ…å†µ 1ï¼šå·¦å³éƒ½æ‰¾åˆ°äº† â†’ root æ˜¯æœ€è¿‘å…¬å…±ç¥–å…ˆ
    if (left && right)
        return root;

    // æƒ…å†µ 2ï¼šåªæœ‰å·¦å­æ ‘æœ‰
    return left ? left : right;
}
```

è¿™æ®µä»£ç å¾ˆçŸ­ï¼Œä½†èƒŒåé€»è¾‘å¼ºå¤§ï¼Œå¯ä»¥è§£å†³ç»å¤§å¤šæ•° LCA å˜ä½“ã€‚

---

#### 14.6.3 å®Œæ•´é€»è¾‘è§£é‡Š

#### **(1) é€’å½’å‡ºå£**

```
if root == nullptr
if root == p
if root == q
```

ä¸€æ—¦é‡åˆ°ç›®æ ‡èŠ‚ç‚¹å°±é©¬ä¸Šè¿”å›å®ƒï¼Œè¿™æ ·ä¿¡æ¯æ‰èƒ½å‘ä¸Šä¼ é€’ã€‚

#### **(2) å·¦å³å­æ ‘é€’å½’**

```
left = dfs(root->left)
right = dfs(root->right)
```

è¿”å›ç»“æœå¯èƒ½æ˜¯ï¼š

* p
* q
* null
* LCAï¼ˆå¦‚æœåœ¨ä¸‹å±‚å­æ ‘å°±æ‰¾åˆ°äº†ï¼‰

#### **(3) åˆ¤æ–­æ˜¯å¦æ‰¾åˆ° LCA**

```
if (left && right)
    return root;
```

æƒ…å†µï¼š

* å·¦å­æ ‘æ‰¾åˆ°äº† p
* å³å­æ ‘æ‰¾åˆ°äº† q
  â†’ è¯´æ˜ p/q åœ¨ root ä¸¤ä¾§å‡ºç°ï¼Œæ­¤æ—¶ root = LCA

#### **(4) å…¶ä»–æƒ…å†µç»§ç»­å‘ä¸Šä¼ é€’**

```
return left ? left : right;
```

å¯èƒ½å‡ºç°ï¼š

* left æ‰¾åˆ° pï¼Œright æ˜¯ null â†’ å‘ä¸Šè¿”å› p
* left æ˜¯ nullï¼Œright æ‰¾åˆ° q â†’ è¿”å› q
* å·¦å³éƒ½æ˜¯ null â†’ è¿”å› null

é€’å½’æœ€ç»ˆæ±‡æ€»åˆ°çœŸæ­£çš„ LCAã€‚

---

#### 14.6.4 ä¸å‰é¢å¸ƒå°”å†™æ³•çš„å¯¹æ¯”

| å†™æ³•       | æœ¬ç«  14.3ï¼ˆå¸ƒå°” + å…¨å±€ï¼‰ | æœ¬èŠ‚ 14.6ï¼ˆç»Ÿä¸€æ¨¡æ¿ï¼‰           |
| -------- | ---------------- | ----------------------- |
| è¿”å›å€¼      | boolï¼ˆæ˜¯å¦åŒ…å« p/qï¼‰   | TreeNode*ï¼ˆè¿”å›æ‰¾åˆ°çš„èŠ‚ç‚¹æˆ– LCAï¼‰ |
| å˜é‡ä¾èµ–     | ans æ˜¯å…¨å±€å˜é‡        | æ— å…¨å±€å˜é‡                   |
| æŸ¥ LCA æ—¶æœº | éœ€è¦ç‰¹å®šæ¡ä»¶åˆ¤æ–­         | å½“å·¦å³åŒæ—¶éç©ºæ—¶ç«‹å³åˆ¤å®š            |
| æ€ç»´æ–¹å‘     | â€œåä»£æ˜¯å¦å‡ºç°â€         | â€œè¿”å›çš„èŠ‚ç‚¹æ˜¯ä»€ä¹ˆâ€              |
| å¯è¯»æ€§      | ç•¥å¤æ‚              | éå¸¸ç®€æ´                    |
| å¯æ‰©å±•æ€§     | å¤„ç†ä¸­ç­‰éš¾åº¦é¢˜è¶³å¤Ÿ        | æ›´é€‚åˆé«˜éš¾åº¦ LCA å˜ä½“           |

**ç»Ÿä¸€æ¨¡æ¿æ›´é€‚åˆåç»­è¿›é˜¶é¢˜ç›®ï¼Œæ¯”å¦‚ï¼š**

* å¸¦çˆ¶æŒ‡é’ˆçš„æ ‘
* k ä¸ªèŠ‚ç‚¹çš„ LCA
* ç»Ÿè®¡è·ç¦»æœ€è¿‘èŠ‚ç‚¹
* æ±‚è·¯å¾„å’Œã€è·¯å¾„å­—ç¬¦ä¸²
* å¸¦æƒæ ‘å›¾çš„ LCA

å®ƒå·²ç»æˆä¸º LeetCodeã€é¢è¯•ã€ç¬”è¯•çš„äº‹å®æ ‡å‡†å†™æ³•ã€‚

---

### 14.7 æ¨¡æ¿é€‚ç”¨ä¸ä¸é€‚ç”¨çš„åœºæ™¯

#### **é€‚ç”¨ï¼šä»»ä½•æ™®é€šäºŒå‰æ ‘çš„ LCA**

åŒ…æ‹¬ï¼š

* å®Œå…¨äºŒå‰æ ‘
* ä»»æ„å½¢çŠ¶çš„æ ‘
* p/q åœ¨ä»»æ„ä½ç½®
* å…è®¸ p == root æˆ– q == root

#### **ä¸é€‚ç”¨ï¼šBSTï¼ˆå› ä¸º BST æœ‰æ›´ä¼˜è§£ï¼‰**

å¯¹äº BSTï¼Œ14.2 çš„ç›´æ¥æ¯”è¾ƒæ ¹èŠ‚ç‚¹æ³•æ•ˆç‡æ›´é«˜ã€‚

---
### 14.8 æ€ç»´å¯è§†åŒ–ï¼šé€’å½’è¿”å›å€¼å°±æ˜¯â€œå‘ä¸Šå†’æ³¡çš„çº¿ç´¢â€

ä½ å¯ä»¥è¿™æ ·ç†è§£ï¼š

```
ä»å¶å­å¼€å§‹ï¼Œp å’Œ q å„è‡ªå¾€ä¸Šâ€œå†’æ³¡â€ã€‚
å½“æŸä¸ªèŠ‚ç‚¹å·¦å³ä¸¤è¾¹éƒ½å†’æ³¡ä¸Šæ¥ä¸€ä¸ªå€¼æ—¶â€”â€”åˆ†å‰ç‚¹å‡ºç°ï¼Œç­”æ¡ˆå°±è¯ç”Ÿã€‚
```

é€’å½’å‡½æ•°çš„è¿”å›å€¼å°±æ˜¯è¿™æ¡â€œå†’æ³¡çº¿ç´¢â€ï¼Œä¸æ–­å‘ä¸Šä¼ é€’ç›´åˆ°æ‰¾åˆ°æœ€ç»ˆçš„æ±‡åˆç‚¹ã€‚

---

### 14.9 å°ç»“

* æ¸…æ™°ï¼šè¿”å›çš„æ˜¯â€œæ‰¾åˆ°çš„èŠ‚ç‚¹â€ï¼Œè¡¨è¾¾ç›´è§‚
* ç®€æ´ï¼š20 è¡Œä»¥å†…è§£å†³ä»»ä½•æ™®é€šäºŒå‰æ ‘ LCA
* å¼ºæ‰©å±•ï¼šæœªæ¥é‡åˆ°æ ‘è·¯å¾„ç±»é¢˜ç›®éƒ½å¯ä»¥ä»æ­¤æ¨¡æ¿å‡ºå‘
* æˆä½“ç³»ï¼šä¸ DFS éå†ã€ååºéå†è‡ªæ´½

ç»Ÿä¸€æ¨¡æ¿æ˜¯æ ‘é¢˜ä¸­æœ€å€¼å¾—èƒŒçš„æ¨¡å¼ä¹‹ä¸€ã€‚

---

## 15. é€šè¿‡ CSP æ°´å°è¯†åˆ«é¢˜ç†è§£å·®åˆ†æ€æƒ³ï¼ˆDifference Arrayï¼‰

å·®åˆ†ï¼ˆDifference Arrayï¼‰æ˜¯ç«èµ›ã€æ•°æ®ç»“æ„å’Œç®—æ³•ä¸­æœ€ç»å…¸ã€åŒæ—¶ä¹Ÿæ˜¯æœ€å®¹æ˜“è¢«è¯¯è§£çš„æŠ€å·§ä¹‹ä¸€ã€‚
æˆ‘ä»¬å°†é€šè¿‡è¿™é“ [*â€œCSP æ°´å°è¯†åˆ«ï¼ˆ5Ã—9 æ¨¡æ¿åœ¨ 9Ã—9 é«˜åº¦çŸ©é˜µä¸­å¯»æ‰¾åˆæ³•é˜ˆå€¼ kï¼‰â€*](https://sim.csp.thusaac.com/contest/39/problem/1) çš„é¢˜ç›®ï¼Œæ·±åº¦ç†è§£å·®åˆ†çš„æœ¬è´¨ä¸åº”ç”¨åœºæ™¯ã€‚

---

### 15.1 é—®é¢˜èƒŒæ™¯å›é¡¾ï¼šå•é˜ˆå€¼äºŒå€¼åŒ– + æ¨¡æ¿åŒ¹é…

ç»™å®šï¼š

* ä¸€ä¸ª 9Ã—9 çš„é«˜åº¦çŸ©é˜µ A
* ä¸€ä¸ªå›ºå®šå½¢çŠ¶çš„ 5Ã—9 æ¨¡æ¿ stï¼ˆé»‘ç‚¹=trueã€ç™½ç‚¹=falseï¼‰
* ä¸€ä¸ªé˜ˆå€¼ kï¼Œå°†çŸ©é˜µäºŒå€¼åŒ–ï¼š

```
A[i][j] â‰¥ k â†’ é»‘ï¼ˆ-ï¼‰
A[i][j] <  k â†’ ç™½ï¼ˆ*ï¼‰
```

æˆ‘ä»¬è¦æ‰¾å‡ºæ‰€æœ‰ kï¼Œä½¿å¾—åœ¨ **æŸä¸ª 5Ã—9 çš„æ»‘åŠ¨çª—å£** ä¸­æ­£å¥½å‡ºç°æ¨¡æ¿ st æ‰€å®šä¹‰çš„å½¢çŠ¶ã€‚

è¾“å‡ºæ‰€æœ‰è¿™æ ·çš„ k å€¼ã€‚

---

### 15.2 æ¯ä¸ªçª—å£å¯¹åº”ä¸€ä¸ªåˆæ³• k çš„åŒºé—´

æ¨¡æ¿ä¸­å®šä¹‰ï¼š

* **é»‘ç‚¹ (st[a][b] = true)** å¿…é¡»æ»¡è¶³ A â‰¥ k
* **ç™½ç‚¹ (st[a][b] = false)** å¿…é¡»æ»¡è¶³ A < k

å› æ­¤ï¼Œå¯¹äºçª—å£å·¦ä¸Šè§’åœ¨ä½ç½® (i, j) çš„ 5Ã—9 åŒºåŸŸï¼Œæˆ‘ä»¬å¯ä»¥æ¨å‡ºï¼š

### é»‘ç‚¹ç»™å‡ºä¸Šç•Œï¼š

```
k â‰¤ min( A[i+a][j+b] )    over all black points
```

### ç™½ç‚¹ç»™å‡ºä¸‹ç•Œï¼š

```
k â‰¥ max( A[i+a][j+b] ) + 1    over all white points
```

äºæ˜¯è¯¥çª—å£å…è®¸çš„ k ä¸ºä¸€ä¸ªè¿ç»­åŒºé—´ï¼š

```
[min_k, max_k]
```

å¦‚æœ min_k > max_kï¼Œåˆ™è¯¥çª—å£æ— åˆæ³• kã€‚

---

### 15.3 å…³é”®è§‚å¯Ÿï¼š

#### **æ¯ä¸€ä¸ªçª—å£ä¸æ˜¯åªå¯¹åº”ä¸€ä¸ª kï¼Œè€Œæ˜¯å¯¹åº”ä¸€ä¸ª k çš„åŒºé—´ã€‚**

ä¾‹å¦‚æŸä¸ªçª—å£å¯èƒ½å…è®¸ï¼š

```
k âˆˆ [4, 5]
```

å¦ä¸€ä¸ªçª—å£å¯èƒ½å…è®¸ï¼š

```
k âˆˆ [7, 7]
```

æ‰€ä»¥æˆ‘ä»¬çš„é—®é¢˜å˜æˆï¼š

> å·²çŸ¥è‹¥å¹²åŒºé—´ [láµ¢, ráµ¢]ï¼Œè¾“å‡ºæ‰€æœ‰è¢«è‡³å°‘ä¸€ä¸ªåŒºé—´è¦†ç›–çš„æ•´æ•° kã€‚

è¿™å°±æ˜¯å…¸å‹çš„â€œå¤šåŒºé—´è¦†ç›–ç»Ÿè®¡â€é—®é¢˜ã€‚

---

### 15.4 ä¸ºä»€ä¹ˆä¸ç”¨æš´åŠ›æ ‡è®°æ¯ä¸ªåŒºé—´ï¼Ÿ

å¦‚æœç›´æ¥å¯¹æ¯ä¸ªçª—å£çš„åŒºé—´æ ‡è®°ï¼š

```cpp
for (k = min_k; k <= max_k; k++)
    cnt[k]++
```

å¯èƒ½ä¼šäº§ç”Ÿæœ€å¤šå‡ åä¸‡ä¸ªæ“ä½œã€‚ä½†å·®åˆ†å¯ä»¥å°†æ¯ä¸ªåŒºé—´ O(r-l+1) çš„æ›´æ–°å˜æˆ **O(1)**ã€‚

---

### 15.5 å·®åˆ†æ€æƒ³ï¼šä¸¤ä¸ªä½ç½®æ›´æ–°å³å¯è¡¨ç¤ºä¸€ä¸ªåŒºé—´

å¯¹äºåŒºé—´ `[l, r]` åšâ€œ+1 æ“ä½œâ€ï¼Œå·®åˆ†æ•°ç»„ diff åªéœ€ï¼š

```cpp
diff[l] += 1
diff[r+1] -= 1
```

éšåé€šè¿‡å‰ç¼€å’Œæ¢å¤ cnt æ•°ç»„ï¼š

```cpp
cnt[k] = diff[0] + diff[1] + ... + diff[k]
```

å‰ç¼€å’Œç´¯åŠ çš„ä½œç”¨ä½¿å¾—ï¼š

* ä» l å¼€å§‹ï¼Œdiff[l] çš„ +1 ä¼šæŒç»­å½±å“æ‰€æœ‰ k â‰¥ l
* åˆ° r+1ï¼Œdiff[r+1] çš„ -1 æŠµæ¶ˆäº†å½±å“ï¼Œè®© k â‰¥ r+1 å†ä¸å—å½±å“

äºæ˜¯ `[l, r]` åŒºé—´å†…è‡ªåŠ¨è¢«åŠ ä¸€ã€‚

### **å·®åˆ†çš„æœ¬è´¨ï¼š

ç”¨ä¸¤æ¬¡å•ç‚¹ä¿®æ”¹å®Œæˆä¸€æ¬¡æ•´ä½“åŒºé—´æ›´æ–°ã€‚**

---

### 15.6 å°†å·®åˆ†åº”ç”¨åˆ°æœ¬é¢˜ï¼šä¸ºçª—å£å¢åŠ åˆæ³• k åŒºé—´

éå†æ‰€æœ‰ 5 ä¸ªçª—å£ï¼ˆå› ä¸º 9Ã—9 ä¸Šæ»‘åŠ¨æ¨¡æ¿å¤§å° 5Ã—9ï¼Œå…± 5 ä¸ªä½ç½®ï¼‰ã€‚

å‡è®¾æŸä¸ªçª—å£åˆæ³•åŒºé—´ä¸ºï¼š

```
[min_k, max_k] = [4, 5]
```

åˆ™åœ¨å·®åˆ†æ•°ç»„ä¸­ï¼š

```cpp
diff[4] += 1
diff[6] -= 1
```

å…¶å®ƒçª—å£è‹¥ä¹Ÿåˆæ³•ï¼Œåˆ™åŒç†æ›´æ–°ã€‚

æœ€ç»ˆå¯èƒ½å¾—åˆ°ï¼ˆç¤ºä¾‹ï¼‰ï¼š

| k | diff[k] |
| - | ------- |
| 4 | +3      |
| 5 | 0       |
| 6 | -3      |
| 7 | +1      |
| 8 | -1      |

---

### 15.7 å‰ç¼€å’Œæ¢å¤ cnt[k]

é€šè¿‡ï¼š

```cpp
cnt[k] += diff[k]
```

å¯æ¢å¤ï¼š

| k | cnt[k] | è§£é‡Š            |
| - | ------ | ------------- |
| 4 | 3      | æœ‰ 3 ä¸ªçª—å£æ”¯æŒ k=4 |
| 5 | 3      | æœ‰ 3 ä¸ªçª—å£æ”¯æŒ k=5 |
| 6 | 0      | æ— çª—å£å¯åŒ¹é…        |
| 7 | 1      | æœ‰ 1 ä¸ªçª—å£æ”¯æŒ k=7 |
| 8 | 0      | æ— çª—å£å¯åŒ¹é…        |

äºæ˜¯æ‰€æœ‰åˆæ³•çš„ k å°±æ˜¯ cnt[k] > 0 çš„ï¼š

```
4
5
7
```

---

### 15.8 æ ‡å‡†å·®åˆ†ä¸åŒºé—´è¦†ç›–çš„ç»Ÿä¸€ç»“è®º

æœ¬é¢˜ç”¨å·®åˆ†ï¼Œæ˜¯å› ä¸ºï¼š

* æ¯ä¸ªçª—å£ç»™å‡ºçš„æ˜¯ä¸€ä¸ªè¿ç»­åŒºé—´
* éœ€è¦åˆå¹¶æ‰€æœ‰çª—å£å¯¹ k çš„å½±å“
* éœ€è¦å¿«é€Ÿåˆ¤æ–­å“ªäº› k æœ‰è‡³å°‘ä¸€ä¸ªçª—å£æ»¡è¶³æ¨¡æ¿

å·®åˆ†å¯ä»¥å®Œç¾å¤„ç†ï¼š

* å¤šä¸ªåŒºé—´åˆå¹¶
* åŒºé—´ç»Ÿè®¡
* åŒºé—´è¦†ç›–è®¡æ•°
* å•è°ƒé˜ˆå€¼åº”ç”¨

å¹¶ä¸”æ—¶é—´å¤æ‚åº¦æä½ã€‚

---

### 15.9 ä¸€å¥è¯æ€»ç»“

> å·®åˆ†æ•°ç»„é€šè¿‡â€œä¸¤ä¸ªä½ç½®æ›´æ–°â€å®ç°â€œä¸€ä¸ªåŒºé—´çš„æ•´ä½“å¢é‡â€ï¼Œ
> åœ¨ CSP æ°´å°è¯†åˆ«é¢˜ä¸­ç”¨äºç»Ÿè®¡æ‰€æœ‰çª—å£å¯¹é˜ˆå€¼ k çš„åˆæ³•æ€§ã€‚
> æœ€ç»ˆé€šè¿‡å‰ç¼€å’Œæ¢å¤è¦†ç›–æ¬¡æ•°ï¼Œæ‰¾åˆ°æ‰€æœ‰æ»¡è¶³æ¨¡æ¿çš„ kã€‚

---
